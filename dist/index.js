import e from"buffer";import t from"stream";import r from"util";import n from"crypto";import{webcrypto as s}from"node:crypto";let i,a;function o(e=21){var t;t=e-=0,!i||i.length<t?(i=Buffer.allocUnsafe(128*t),s.getRandomValues(i),a=0):a+t>i.length&&(s.getRandomValues(i),a=0),a+=t;let r="";for(let t=a-e;t<a;t++)r+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[63&i[t]];return r}function c(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var u,l;!function(e){e.assertEqual=e=>e,e.assertIs=function(e){},e.assertNever=function(e){throw new Error},e.arrayToEnum=e=>{const t={};for(const r of e)t[r]=r;return t},e.getValidEnumValues=t=>{const r=e.objectKeys(t).filter((e=>"number"!=typeof t[t[e]])),n={};for(const e of r)n[e]=t[e];return e.objectValues(n)},e.objectValues=t=>e.objectKeys(t).map((function(e){return t[e]})),e.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{const t=[];for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t},e.find=(e,t)=>{for(const r of e)if(t(r))return r},e.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e,t=" | "){return e.map((e=>"string"==typeof e?`'${e}'`:e)).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t}(u||(u={})),function(e){e.mergeShapes=(e,t)=>({...e,...t})}(l||(l={}));const d=u.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),p=e=>{switch(typeof e){case"undefined":return d.undefined;case"string":return d.string;case"number":return isNaN(e)?d.nan:d.number;case"boolean":return d.boolean;case"function":return d.function;case"bigint":return d.bigint;case"symbol":return d.symbol;case"object":return Array.isArray(e)?d.array:null===e?d.null:e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch?d.promise:"undefined"!=typeof Map&&e instanceof Map?d.map:"undefined"!=typeof Set&&e instanceof Set?d.set:"undefined"!=typeof Date&&e instanceof Date?d.date:d.object;default:return d.unknown}},h=u.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class f extends Error{constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const t=e||function(e){return e.message},r={_errors:[]},n=e=>{for(const s of e.issues)if("invalid_union"===s.code)s.unionErrors.map(n);else if("invalid_return_type"===s.code)n(s.returnTypeError);else if("invalid_arguments"===s.code)n(s.argumentsError);else if(0===s.path.length)r._errors.push(t(s));else{let e=r,n=0;for(;n<s.path.length;){const r=s.path[n];n===s.path.length-1?(e[r]=e[r]||{_errors:[]},e[r]._errors.push(t(s))):e[r]=e[r]||{_errors:[]},e=e[r],n++}}};return n(this),r}static assert(e){if(!(e instanceof f))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,u.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){const t={},r=[];for(const n of this.issues)n.path.length>0?(t[n.path[0]]=t[n.path[0]]||[],t[n.path[0]].push(e(n))):r.push(e(n));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}f.create=e=>new f(e);const m=(e,t)=>{let r;switch(e.code){case h.invalid_type:r=e.received===d.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case h.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,u.jsonStringifyReplacer)}`;break;case h.unrecognized_keys:r=`Unrecognized key(s) in object: ${u.joinValues(e.keys,", ")}`;break;case h.invalid_union:r="Invalid input";break;case h.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${u.joinValues(e.options)}`;break;case h.invalid_enum_value:r=`Invalid enum value. Expected ${u.joinValues(e.options)}, received '${e.received}'`;break;case h.invalid_arguments:r="Invalid function arguments";break;case h.invalid_return_type:r="Invalid function return type";break;case h.invalid_date:r="Invalid date";break;case h.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:u.assertNever(e.validation):r="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case h.too_small:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case h.too_big:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case h.custom:r="Invalid input";break;case h.invalid_intersection_types:r="Intersection results could not be merged";break;case h.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case h.not_finite:r="Number must be finite";break;default:r=t.defaultError,u.assertNever(e)}return{message:r}};let y=m;function v(){return y}const g=e=>{const{data:t,path:r,errorMaps:n,issueData:s}=e,i=[...r,...s.path||[]],a={...s,path:i};if(void 0!==s.message)return{...s,path:i,message:s.message};let o="";const c=n.filter((e=>!!e)).slice().reverse();for(const e of c)o=e(a,{data:t,defaultError:o}).message;return{...s,path:i,message:o}};function _(e,t){const r=v(),n=g({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===m?void 0:m].filter((e=>!!e))});e.common.issues.push(n)}class b{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){const r=[];for(const n of t){if("aborted"===n.status)return E;"dirty"===n.status&&e.dirty(),r.push(n.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){const r=[];for(const e of t){const t=await e.key,n=await e.value;r.push({key:t,value:n})}return b.mergeObjectSync(e,r)}static mergeObjectSync(e,t){const r={};for(const n of t){const{key:t,value:s}=n;if("aborted"===t.status)return E;if("aborted"===s.status)return E;"dirty"===t.status&&e.dirty(),"dirty"===s.status&&e.dirty(),"__proto__"===t.value||void 0===s.value&&!n.alwaysSet||(r[t.value]=s.value)}return{status:e.value,value:r}}}const E=Object.freeze({status:"aborted"}),w=e=>({status:"dirty",value:e}),S=e=>({status:"valid",value:e}),x=e=>"aborted"===e.status,k=e=>"dirty"===e.status,O=e=>"valid"===e.status,T=e=>"undefined"!=typeof Promise&&e instanceof Promise;function I(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function $(e,t,r,n,s){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?s.call(e,r):s?s.value=r:t.set(e,r),r}var R,N,j;"function"==typeof SuppressedError&&SuppressedError,function(e){e.errToObj=e=>"string"==typeof e?{message:e}:e||{},e.toString=e=>"string"==typeof e?e:null==e?void 0:e.message}(R||(R={}));class A{constructor(e,t,r,n){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const P=(e,t)=>{if(O(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new f(e.common.issues);return this._error=t,this._error}}};function L(e){if(!e)return{};const{errorMap:t,invalid_type_error:r,required_error:n,description:s}=e;if(t&&(r||n))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');if(t)return{errorMap:t,description:s};return{errorMap:(t,s)=>{var i,a;const{message:o}=e;return"invalid_enum_value"===t.code?{message:null!=o?o:s.defaultError}:void 0===s.data?{message:null!==(i=null!=o?o:n)&&void 0!==i?i:s.defaultError}:"invalid_type"!==t.code?{message:s.defaultError}:{message:null!==(a=null!=o?o:r)&&void 0!==a?a:s.defaultError}},description:s}}class C{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return p(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:p(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new b,ctx:{common:e.parent.common,data:e.data,parsedType:p(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(T(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){var r;const n={common:{issues:[],async:null!==(r=null==t?void 0:t.async)&&void 0!==r&&r,contextualErrorMap:null==t?void 0:t.errorMap},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:p(e)},s=this._parseSync({data:e,path:n.path,parent:n});return P(n,s)}async parseAsync(e,t){const r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){const r={common:{issues:[],contextualErrorMap:null==t?void 0:t.errorMap,async:!0},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:p(e)},n=this._parse({data:e,path:r.path,parent:r}),s=await(T(n)?n:Promise.resolve(n));return P(r,s)}refine(e,t){const r=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement(((t,n)=>{const s=e(t),i=()=>n.addIssue({code:h.custom,...r(t)});return"undefined"!=typeof Promise&&s instanceof Promise?s.then((e=>!!e||(i(),!1))):!!s||(i(),!1)}))}refinement(e,t){return this._refinement(((r,n)=>!!e(r)||(n.addIssue("function"==typeof t?t(r,n):t),!1)))}_refinement(e){return new Re({schema:this,typeName:Be.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return Ne.create(this,this._def)}nullable(){return je.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return de.create(this,this._def)}promise(){return $e.create(this,this._def)}or(e){return fe.create([this,e],this._def)}and(e){return ge.create(this,e,this._def)}transform(e){return new Re({...L(this._def),schema:this,typeName:Be.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t="function"==typeof e?e:()=>e;return new Ae({...L(this._def),innerType:this,defaultValue:t,typeName:Be.ZodDefault})}brand(){return new Ze({typeName:Be.ZodBranded,type:this,...L(this._def)})}catch(e){const t="function"==typeof e?e:()=>e;return new Pe({...L(this._def),innerType:this,catchValue:t,typeName:Be.ZodCatch})}describe(e){return new(0,this.constructor)({...this._def,description:e})}pipe(e){return Me.create(this,e)}readonly(){return De.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Z=/^c[^\s-]{8,}$/i,M=/^[0-9a-z]+$/,D=/^[0-9A-HJKMNP-TV-Z]{26}$/,U=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,V=/^[a-z0-9_-]{21}$/i,B=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,K=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i;let F;const G=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,z=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,H=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,X="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",W=new RegExp(`^${X}$`);function q(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:null==e.precision&&(t=`${t}(\\.\\d+)?`),t}function J(e){let t=`${X}T${q(e)}`;const r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}class Y extends C{_parse(e){this._def.coerce&&(e.data=String(e.data));if(this._getType(e)!==d.string){const t=this._getOrReturnCtx(e);return _(t,{code:h.invalid_type,expected:d.string,received:t.parsedType}),E}const t=new b;let r;for(const i of this._def.checks)if("min"===i.kind)e.data.length<i.value&&(r=this._getOrReturnCtx(e,r),_(r,{code:h.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),t.dirty());else if("max"===i.kind)e.data.length>i.value&&(r=this._getOrReturnCtx(e,r),_(r,{code:h.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),t.dirty());else if("length"===i.kind){const n=e.data.length>i.value,s=e.data.length<i.value;(n||s)&&(r=this._getOrReturnCtx(e,r),n?_(r,{code:h.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):s&&_(r,{code:h.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),t.dirty())}else if("email"===i.kind)K.test(e.data)||(r=this._getOrReturnCtx(e,r),_(r,{validation:"email",code:h.invalid_string,message:i.message}),t.dirty());else if("emoji"===i.kind)F||(F=new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),F.test(e.data)||(r=this._getOrReturnCtx(e,r),_(r,{validation:"emoji",code:h.invalid_string,message:i.message}),t.dirty());else if("uuid"===i.kind)U.test(e.data)||(r=this._getOrReturnCtx(e,r),_(r,{validation:"uuid",code:h.invalid_string,message:i.message}),t.dirty());else if("nanoid"===i.kind)V.test(e.data)||(r=this._getOrReturnCtx(e,r),_(r,{validation:"nanoid",code:h.invalid_string,message:i.message}),t.dirty());else if("cuid"===i.kind)Z.test(e.data)||(r=this._getOrReturnCtx(e,r),_(r,{validation:"cuid",code:h.invalid_string,message:i.message}),t.dirty());else if("cuid2"===i.kind)M.test(e.data)||(r=this._getOrReturnCtx(e,r),_(r,{validation:"cuid2",code:h.invalid_string,message:i.message}),t.dirty());else if("ulid"===i.kind)D.test(e.data)||(r=this._getOrReturnCtx(e,r),_(r,{validation:"ulid",code:h.invalid_string,message:i.message}),t.dirty());else if("url"===i.kind)try{new URL(e.data)}catch(n){r=this._getOrReturnCtx(e,r),_(r,{validation:"url",code:h.invalid_string,message:i.message}),t.dirty()}else if("regex"===i.kind){i.regex.lastIndex=0;i.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),_(r,{validation:"regex",code:h.invalid_string,message:i.message}),t.dirty())}else if("trim"===i.kind)e.data=e.data.trim();else if("includes"===i.kind)e.data.includes(i.value,i.position)||(r=this._getOrReturnCtx(e,r),_(r,{code:h.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),t.dirty());else if("toLowerCase"===i.kind)e.data=e.data.toLowerCase();else if("toUpperCase"===i.kind)e.data=e.data.toUpperCase();else if("startsWith"===i.kind)e.data.startsWith(i.value)||(r=this._getOrReturnCtx(e,r),_(r,{code:h.invalid_string,validation:{startsWith:i.value},message:i.message}),t.dirty());else if("endsWith"===i.kind)e.data.endsWith(i.value)||(r=this._getOrReturnCtx(e,r),_(r,{code:h.invalid_string,validation:{endsWith:i.value},message:i.message}),t.dirty());else if("datetime"===i.kind){J(i).test(e.data)||(r=this._getOrReturnCtx(e,r),_(r,{code:h.invalid_string,validation:"datetime",message:i.message}),t.dirty())}else if("date"===i.kind){W.test(e.data)||(r=this._getOrReturnCtx(e,r),_(r,{code:h.invalid_string,validation:"date",message:i.message}),t.dirty())}else if("time"===i.kind){new RegExp(`^${q(i)}$`).test(e.data)||(r=this._getOrReturnCtx(e,r),_(r,{code:h.invalid_string,validation:"time",message:i.message}),t.dirty())}else"duration"===i.kind?B.test(e.data)||(r=this._getOrReturnCtx(e,r),_(r,{validation:"duration",code:h.invalid_string,message:i.message}),t.dirty()):"ip"===i.kind?(n=e.data,("v4"!==(s=i.version)&&s||!G.test(n))&&("v6"!==s&&s||!z.test(n))&&(r=this._getOrReturnCtx(e,r),_(r,{validation:"ip",code:h.invalid_string,message:i.message}),t.dirty())):"base64"===i.kind?H.test(e.data)||(r=this._getOrReturnCtx(e,r),_(r,{validation:"base64",code:h.invalid_string,message:i.message}),t.dirty()):u.assertNever(i);var n,s;return{status:t.value,value:e.data}}_regex(e,t,r){return this.refinement((t=>e.test(t)),{validation:t,code:h.invalid_string,...R.errToObj(r)})}_addCheck(e){return new Y({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...R.errToObj(e)})}url(e){return this._addCheck({kind:"url",...R.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...R.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...R.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...R.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...R.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...R.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...R.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...R.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...R.errToObj(e)})}datetime(e){var t,r;return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,offset:null!==(t=null==e?void 0:e.offset)&&void 0!==t&&t,local:null!==(r=null==e?void 0:e.local)&&void 0!==r&&r,...R.errToObj(null==e?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"==typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,...R.errToObj(null==e?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...R.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...R.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:null==t?void 0:t.position,...R.errToObj(null==t?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...R.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...R.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...R.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...R.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...R.errToObj(t)})}nonempty(e){return this.min(1,R.errToObj(e))}trim(){return new Y({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Y({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Y({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find((e=>"datetime"===e.kind))}get isDate(){return!!this._def.checks.find((e=>"date"===e.kind))}get isTime(){return!!this._def.checks.find((e=>"time"===e.kind))}get isDuration(){return!!this._def.checks.find((e=>"duration"===e.kind))}get isEmail(){return!!this._def.checks.find((e=>"email"===e.kind))}get isURL(){return!!this._def.checks.find((e=>"url"===e.kind))}get isEmoji(){return!!this._def.checks.find((e=>"emoji"===e.kind))}get isUUID(){return!!this._def.checks.find((e=>"uuid"===e.kind))}get isNANOID(){return!!this._def.checks.find((e=>"nanoid"===e.kind))}get isCUID(){return!!this._def.checks.find((e=>"cuid"===e.kind))}get isCUID2(){return!!this._def.checks.find((e=>"cuid2"===e.kind))}get isULID(){return!!this._def.checks.find((e=>"ulid"===e.kind))}get isIP(){return!!this._def.checks.find((e=>"ip"===e.kind))}get isBase64(){return!!this._def.checks.find((e=>"base64"===e.kind))}get minLength(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}function Q(e,t){const r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,s=r>n?r:n;return parseInt(e.toFixed(s).replace(".",""))%parseInt(t.toFixed(s).replace(".",""))/Math.pow(10,s)}Y.create=e=>{var t;return new Y({checks:[],typeName:Be.ZodString,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...L(e)})};class ee extends C{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){this._def.coerce&&(e.data=Number(e.data));if(this._getType(e)!==d.number){const t=this._getOrReturnCtx(e);return _(t,{code:h.invalid_type,expected:d.number,received:t.parsedType}),E}let t;const r=new b;for(const n of this._def.checks)if("int"===n.kind)u.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),_(t,{code:h.invalid_type,expected:"integer",received:"float",message:n.message}),r.dirty());else if("min"===n.kind){(n.inclusive?e.data<n.value:e.data<=n.value)&&(t=this._getOrReturnCtx(e,t),_(t,{code:h.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty())}else if("max"===n.kind){(n.inclusive?e.data>n.value:e.data>=n.value)&&(t=this._getOrReturnCtx(e,t),_(t,{code:h.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty())}else"multipleOf"===n.kind?0!==Q(e.data,n.value)&&(t=this._getOrReturnCtx(e,t),_(t,{code:h.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):"finite"===n.kind?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),_(t,{code:h.not_finite,message:n.message}),r.dirty()):u.assertNever(n);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,R.toString(t))}gt(e,t){return this.setLimit("min",e,!1,R.toString(t))}lte(e,t){return this.setLimit("max",e,!0,R.toString(t))}lt(e,t){return this.setLimit("max",e,!1,R.toString(t))}setLimit(e,t,r,n){return new ee({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:R.toString(n)}]})}_addCheck(e){return new ee({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:R.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:R.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:R.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:R.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:R.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:R.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:R.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:R.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:R.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find((e=>"int"===e.kind||"multipleOf"===e.kind&&u.isInteger(e.value)))}get isFinite(){let e=null,t=null;for(const r of this._def.checks){if("finite"===r.kind||"int"===r.kind||"multipleOf"===r.kind)return!0;"min"===r.kind?(null===t||r.value>t)&&(t=r.value):"max"===r.kind&&(null===e||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}ee.create=e=>new ee({checks:[],typeName:Be.ZodNumber,coerce:(null==e?void 0:e.coerce)||!1,...L(e)});class te extends C{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){this._def.coerce&&(e.data=BigInt(e.data));if(this._getType(e)!==d.bigint){const t=this._getOrReturnCtx(e);return _(t,{code:h.invalid_type,expected:d.bigint,received:t.parsedType}),E}let t;const r=new b;for(const n of this._def.checks)if("min"===n.kind){(n.inclusive?e.data<n.value:e.data<=n.value)&&(t=this._getOrReturnCtx(e,t),_(t,{code:h.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty())}else if("max"===n.kind){(n.inclusive?e.data>n.value:e.data>=n.value)&&(t=this._getOrReturnCtx(e,t),_(t,{code:h.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty())}else"multipleOf"===n.kind?e.data%n.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),_(t,{code:h.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):u.assertNever(n);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,R.toString(t))}gt(e,t){return this.setLimit("min",e,!1,R.toString(t))}lte(e,t){return this.setLimit("max",e,!0,R.toString(t))}lt(e,t){return this.setLimit("max",e,!1,R.toString(t))}setLimit(e,t,r,n){return new te({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:R.toString(n)}]})}_addCheck(e){return new te({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:R.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:R.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:R.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:R.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:R.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}te.create=e=>{var t;return new te({checks:[],typeName:Be.ZodBigInt,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...L(e)})};class re extends C{_parse(e){this._def.coerce&&(e.data=Boolean(e.data));if(this._getType(e)!==d.boolean){const t=this._getOrReturnCtx(e);return _(t,{code:h.invalid_type,expected:d.boolean,received:t.parsedType}),E}return S(e.data)}}re.create=e=>new re({typeName:Be.ZodBoolean,coerce:(null==e?void 0:e.coerce)||!1,...L(e)});class ne extends C{_parse(e){this._def.coerce&&(e.data=new Date(e.data));if(this._getType(e)!==d.date){const t=this._getOrReturnCtx(e);return _(t,{code:h.invalid_type,expected:d.date,received:t.parsedType}),E}if(isNaN(e.data.getTime())){return _(this._getOrReturnCtx(e),{code:h.invalid_date}),E}const t=new b;let r;for(const n of this._def.checks)"min"===n.kind?e.data.getTime()<n.value&&(r=this._getOrReturnCtx(e,r),_(r,{code:h.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),t.dirty()):"max"===n.kind?e.data.getTime()>n.value&&(r=this._getOrReturnCtx(e,r),_(r,{code:h.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),t.dirty()):u.assertNever(n);return{status:t.value,value:new Date(e.data.getTime())}}_addCheck(e){return new ne({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:R.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:R.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}ne.create=e=>new ne({checks:[],coerce:(null==e?void 0:e.coerce)||!1,typeName:Be.ZodDate,...L(e)});class se extends C{_parse(e){if(this._getType(e)!==d.symbol){const t=this._getOrReturnCtx(e);return _(t,{code:h.invalid_type,expected:d.symbol,received:t.parsedType}),E}return S(e.data)}}se.create=e=>new se({typeName:Be.ZodSymbol,...L(e)});class ie extends C{_parse(e){if(this._getType(e)!==d.undefined){const t=this._getOrReturnCtx(e);return _(t,{code:h.invalid_type,expected:d.undefined,received:t.parsedType}),E}return S(e.data)}}ie.create=e=>new ie({typeName:Be.ZodUndefined,...L(e)});class ae extends C{_parse(e){if(this._getType(e)!==d.null){const t=this._getOrReturnCtx(e);return _(t,{code:h.invalid_type,expected:d.null,received:t.parsedType}),E}return S(e.data)}}ae.create=e=>new ae({typeName:Be.ZodNull,...L(e)});class oe extends C{constructor(){super(...arguments),this._any=!0}_parse(e){return S(e.data)}}oe.create=e=>new oe({typeName:Be.ZodAny,...L(e)});class ce extends C{constructor(){super(...arguments),this._unknown=!0}_parse(e){return S(e.data)}}ce.create=e=>new ce({typeName:Be.ZodUnknown,...L(e)});class ue extends C{_parse(e){const t=this._getOrReturnCtx(e);return _(t,{code:h.invalid_type,expected:d.never,received:t.parsedType}),E}}ue.create=e=>new ue({typeName:Be.ZodNever,...L(e)});class le extends C{_parse(e){if(this._getType(e)!==d.undefined){const t=this._getOrReturnCtx(e);return _(t,{code:h.invalid_type,expected:d.void,received:t.parsedType}),E}return S(e.data)}}le.create=e=>new le({typeName:Be.ZodVoid,...L(e)});class de extends C{_parse(e){const{ctx:t,status:r}=this._processInputParams(e),n=this._def;if(t.parsedType!==d.array)return _(t,{code:h.invalid_type,expected:d.array,received:t.parsedType}),E;if(null!==n.exactLength){const e=t.data.length>n.exactLength.value,s=t.data.length<n.exactLength.value;(e||s)&&(_(t,{code:e?h.too_big:h.too_small,minimum:s?n.exactLength.value:void 0,maximum:e?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),r.dirty())}if(null!==n.minLength&&t.data.length<n.minLength.value&&(_(t,{code:h.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),r.dirty()),null!==n.maxLength&&t.data.length>n.maxLength.value&&(_(t,{code:h.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map(((e,r)=>n.type._parseAsync(new A(t,e,t.path,r))))).then((e=>b.mergeArray(r,e)));const s=[...t.data].map(((e,r)=>n.type._parseSync(new A(t,e,t.path,r))));return b.mergeArray(r,s)}get element(){return this._def.type}min(e,t){return new de({...this._def,minLength:{value:e,message:R.toString(t)}})}max(e,t){return new de({...this._def,maxLength:{value:e,message:R.toString(t)}})}length(e,t){return new de({...this._def,exactLength:{value:e,message:R.toString(t)}})}nonempty(e){return this.min(1,e)}}function pe(e){if(e instanceof he){const t={};for(const r in e.shape){const n=e.shape[r];t[r]=Ne.create(pe(n))}return new he({...e._def,shape:()=>t})}return e instanceof de?new de({...e._def,type:pe(e.element)}):e instanceof Ne?Ne.create(pe(e.unwrap())):e instanceof je?je.create(pe(e.unwrap())):e instanceof _e?_e.create(e.items.map((e=>pe(e)))):e}de.create=(e,t)=>new de({type:e,minLength:null,maxLength:null,exactLength:null,typeName:Be.ZodArray,...L(t)});class he extends C{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;const e=this._def.shape(),t=u.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==d.object){const t=this._getOrReturnCtx(e);return _(t,{code:h.invalid_type,expected:d.object,received:t.parsedType}),E}const{status:t,ctx:r}=this._processInputParams(e),{shape:n,keys:s}=this._getCached(),i=[];if(!(this._def.catchall instanceof ue&&"strip"===this._def.unknownKeys))for(const e in r.data)s.includes(e)||i.push(e);const a=[];for(const e of s){const t=n[e],s=r.data[e];a.push({key:{status:"valid",value:e},value:t._parse(new A(r,s,r.path,e)),alwaysSet:e in r.data})}if(this._def.catchall instanceof ue){const e=this._def.unknownKeys;if("passthrough"===e)for(const e of i)a.push({key:{status:"valid",value:e},value:{status:"valid",value:r.data[e]}});else if("strict"===e)i.length>0&&(_(r,{code:h.unrecognized_keys,keys:i}),t.dirty());else if("strip"!==e)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const e=this._def.catchall;for(const t of i){const n=r.data[t];a.push({key:{status:"valid",value:t},value:e._parse(new A(r,n,r.path,t)),alwaysSet:t in r.data})}}return r.common.async?Promise.resolve().then((async()=>{const e=[];for(const t of a){const r=await t.key,n=await t.value;e.push({key:r,value:n,alwaysSet:t.alwaysSet})}return e})).then((e=>b.mergeObjectSync(t,e))):b.mergeObjectSync(t,a)}get shape(){return this._def.shape()}strict(e){return R.errToObj,new he({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,r)=>{var n,s,i,a;const o=null!==(i=null===(s=(n=this._def).errorMap)||void 0===s?void 0:s.call(n,t,r).message)&&void 0!==i?i:r.defaultError;return"unrecognized_keys"===t.code?{message:null!==(a=R.errToObj(e).message)&&void 0!==a?a:o}:{message:o}}}:{}})}strip(){return new he({...this._def,unknownKeys:"strip"})}passthrough(){return new he({...this._def,unknownKeys:"passthrough"})}extend(e){return new he({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new he({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Be.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new he({...this._def,catchall:e})}pick(e){const t={};return u.objectKeys(e).forEach((r=>{e[r]&&this.shape[r]&&(t[r]=this.shape[r])})),new he({...this._def,shape:()=>t})}omit(e){const t={};return u.objectKeys(this.shape).forEach((r=>{e[r]||(t[r]=this.shape[r])})),new he({...this._def,shape:()=>t})}deepPartial(){return pe(this)}partial(e){const t={};return u.objectKeys(this.shape).forEach((r=>{const n=this.shape[r];e&&!e[r]?t[r]=n:t[r]=n.optional()})),new he({...this._def,shape:()=>t})}required(e){const t={};return u.objectKeys(this.shape).forEach((r=>{if(e&&!e[r])t[r]=this.shape[r];else{let e=this.shape[r];for(;e instanceof Ne;)e=e._def.innerType;t[r]=e}})),new he({...this._def,shape:()=>t})}keyof(){return Oe(u.objectKeys(this.shape))}}he.create=(e,t)=>new he({shape:()=>e,unknownKeys:"strip",catchall:ue.create(),typeName:Be.ZodObject,...L(t)}),he.strictCreate=(e,t)=>new he({shape:()=>e,unknownKeys:"strict",catchall:ue.create(),typeName:Be.ZodObject,...L(t)}),he.lazycreate=(e,t)=>new he({shape:e,unknownKeys:"strip",catchall:ue.create(),typeName:Be.ZodObject,...L(t)});class fe extends C{_parse(e){const{ctx:t}=this._processInputParams(e),r=this._def.options;if(t.common.async)return Promise.all(r.map((async e=>{const r={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:r}),ctx:r}}))).then((function(e){for(const t of e)if("valid"===t.result.status)return t.result;for(const r of e)if("dirty"===r.result.status)return t.common.issues.push(...r.ctx.common.issues),r.result;const r=e.map((e=>new f(e.ctx.common.issues)));return _(t,{code:h.invalid_union,unionErrors:r}),E}));{let e;const n=[];for(const s of r){const r={...t,common:{...t.common,issues:[]},parent:null},i=s._parseSync({data:t.data,path:t.path,parent:r});if("valid"===i.status)return i;"dirty"!==i.status||e||(e={result:i,ctx:r}),r.common.issues.length&&n.push(r.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;const s=n.map((e=>new f(e)));return _(t,{code:h.invalid_union,unionErrors:s}),E}}get options(){return this._def.options}}fe.create=(e,t)=>new fe({options:e,typeName:Be.ZodUnion,...L(t)});const me=e=>e instanceof xe?me(e.schema):e instanceof Re?me(e.innerType()):e instanceof ke?[e.value]:e instanceof Te?e.options:e instanceof Ie?u.objectValues(e.enum):e instanceof Ae?me(e._def.innerType):e instanceof ie?[void 0]:e instanceof ae?[null]:e instanceof Ne?[void 0,...me(e.unwrap())]:e instanceof je?[null,...me(e.unwrap())]:e instanceof Ze||e instanceof De?me(e.unwrap()):e instanceof Pe?me(e._def.innerType):[];class ye extends C{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==d.object)return _(t,{code:h.invalid_type,expected:d.object,received:t.parsedType}),E;const r=this.discriminator,n=t.data[r],s=this.optionsMap.get(n);return s?t.common.async?s._parseAsync({data:t.data,path:t.path,parent:t}):s._parseSync({data:t.data,path:t.path,parent:t}):(_(t,{code:h.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),E)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){const n=new Map;for(const r of t){const t=me(r.shape[e]);if(!t.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const s of t){if(n.has(s))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(s)}`);n.set(s,r)}}return new ye({typeName:Be.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:n,...L(r)})}}function ve(e,t){const r=p(e),n=p(t);if(e===t)return{valid:!0,data:e};if(r===d.object&&n===d.object){const r=u.objectKeys(t),n=u.objectKeys(e).filter((e=>-1!==r.indexOf(e))),s={...e,...t};for(const r of n){const n=ve(e[r],t[r]);if(!n.valid)return{valid:!1};s[r]=n.data}return{valid:!0,data:s}}if(r===d.array&&n===d.array){if(e.length!==t.length)return{valid:!1};const r=[];for(let n=0;n<e.length;n++){const s=ve(e[n],t[n]);if(!s.valid)return{valid:!1};r.push(s.data)}return{valid:!0,data:r}}return r===d.date&&n===d.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class ge extends C{_parse(e){const{status:t,ctx:r}=this._processInputParams(e),n=(e,n)=>{if(x(e)||x(n))return E;const s=ve(e.value,n.value);return s.valid?((k(e)||k(n))&&t.dirty(),{status:t.value,value:s.data}):(_(r,{code:h.invalid_intersection_types}),E)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then((([e,t])=>n(e,t))):n(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}ge.create=(e,t,r)=>new ge({left:e,right:t,typeName:Be.ZodIntersection,...L(r)});class _e extends C{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==d.array)return _(r,{code:h.invalid_type,expected:d.array,received:r.parsedType}),E;if(r.data.length<this._def.items.length)return _(r,{code:h.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),E;!this._def.rest&&r.data.length>this._def.items.length&&(_(r,{code:h.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const n=[...r.data].map(((e,t)=>{const n=this._def.items[t]||this._def.rest;return n?n._parse(new A(r,e,r.path,t)):null})).filter((e=>!!e));return r.common.async?Promise.all(n).then((e=>b.mergeArray(t,e))):b.mergeArray(t,n)}get items(){return this._def.items}rest(e){return new _e({...this._def,rest:e})}}_e.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new _e({items:e,typeName:Be.ZodTuple,rest:null,...L(t)})};class be extends C{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==d.object)return _(r,{code:h.invalid_type,expected:d.object,received:r.parsedType}),E;const n=[],s=this._def.keyType,i=this._def.valueType;for(const e in r.data)n.push({key:s._parse(new A(r,e,r.path,e)),value:i._parse(new A(r,r.data[e],r.path,e)),alwaysSet:e in r.data});return r.common.async?b.mergeObjectAsync(t,n):b.mergeObjectSync(t,n)}get element(){return this._def.valueType}static create(e,t,r){return new be(t instanceof C?{keyType:e,valueType:t,typeName:Be.ZodRecord,...L(r)}:{keyType:Y.create(),valueType:e,typeName:Be.ZodRecord,...L(t)})}}class Ee extends C{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==d.map)return _(r,{code:h.invalid_type,expected:d.map,received:r.parsedType}),E;const n=this._def.keyType,s=this._def.valueType,i=[...r.data.entries()].map((([e,t],i)=>({key:n._parse(new A(r,e,r.path,[i,"key"])),value:s._parse(new A(r,t,r.path,[i,"value"]))})));if(r.common.async){const e=new Map;return Promise.resolve().then((async()=>{for(const r of i){const n=await r.key,s=await r.value;if("aborted"===n.status||"aborted"===s.status)return E;"dirty"!==n.status&&"dirty"!==s.status||t.dirty(),e.set(n.value,s.value)}return{status:t.value,value:e}}))}{const e=new Map;for(const r of i){const n=r.key,s=r.value;if("aborted"===n.status||"aborted"===s.status)return E;"dirty"!==n.status&&"dirty"!==s.status||t.dirty(),e.set(n.value,s.value)}return{status:t.value,value:e}}}}Ee.create=(e,t,r)=>new Ee({valueType:t,keyType:e,typeName:Be.ZodMap,...L(r)});class we extends C{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==d.set)return _(r,{code:h.invalid_type,expected:d.set,received:r.parsedType}),E;const n=this._def;null!==n.minSize&&r.data.size<n.minSize.value&&(_(r,{code:h.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),t.dirty()),null!==n.maxSize&&r.data.size>n.maxSize.value&&(_(r,{code:h.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),t.dirty());const s=this._def.valueType;function i(e){const r=new Set;for(const n of e){if("aborted"===n.status)return E;"dirty"===n.status&&t.dirty(),r.add(n.value)}return{status:t.value,value:r}}const a=[...r.data.values()].map(((e,t)=>s._parse(new A(r,e,r.path,t))));return r.common.async?Promise.all(a).then((e=>i(e))):i(a)}min(e,t){return new we({...this._def,minSize:{value:e,message:R.toString(t)}})}max(e,t){return new we({...this._def,maxSize:{value:e,message:R.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}we.create=(e,t)=>new we({valueType:e,minSize:null,maxSize:null,typeName:Be.ZodSet,...L(t)});class Se extends C{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==d.function)return _(t,{code:h.invalid_type,expected:d.function,received:t.parsedType}),E;function r(e,r){return g({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,v(),m].filter((e=>!!e)),issueData:{code:h.invalid_arguments,argumentsError:r}})}function n(e,r){return g({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,v(),m].filter((e=>!!e)),issueData:{code:h.invalid_return_type,returnTypeError:r}})}const s={errorMap:t.common.contextualErrorMap},i=t.data;if(this._def.returns instanceof $e){const e=this;return S((async function(...t){const a=new f([]),o=await e._def.args.parseAsync(t,s).catch((e=>{throw a.addIssue(r(t,e)),a})),c=await Reflect.apply(i,this,o);return await e._def.returns._def.type.parseAsync(c,s).catch((e=>{throw a.addIssue(n(c,e)),a}))}))}{const e=this;return S((function(...t){const a=e._def.args.safeParse(t,s);if(!a.success)throw new f([r(t,a.error)]);const o=Reflect.apply(i,this,a.data),c=e._def.returns.safeParse(o,s);if(!c.success)throw new f([n(o,c.error)]);return c.data}))}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Se({...this._def,args:_e.create(e).rest(ce.create())})}returns(e){return new Se({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new Se({args:e||_e.create([]).rest(ce.create()),returns:t||ce.create(),typeName:Be.ZodFunction,...L(r)})}}class xe extends C{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}xe.create=(e,t)=>new xe({getter:e,typeName:Be.ZodLazy,...L(t)});class ke extends C{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return _(t,{received:t.data,code:h.invalid_literal,expected:this._def.value}),E}return{status:"valid",value:e.data}}get value(){return this._def.value}}function Oe(e,t){return new Te({values:e,typeName:Be.ZodEnum,...L(t)})}ke.create=(e,t)=>new ke({value:e,typeName:Be.ZodLiteral,...L(t)});class Te extends C{constructor(){super(...arguments),N.set(this,void 0)}_parse(e){if("string"!=typeof e.data){const t=this._getOrReturnCtx(e),r=this._def.values;return _(t,{expected:u.joinValues(r),received:t.parsedType,code:h.invalid_type}),E}if(I(this,N,"f")||$(this,N,new Set(this._def.values),"f"),!I(this,N,"f").has(e.data)){const t=this._getOrReturnCtx(e),r=this._def.values;return _(t,{received:t.data,code:h.invalid_enum_value,options:r}),E}return S(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return Te.create(e,{...this._def,...t})}exclude(e,t=this._def){return Te.create(this.options.filter((t=>!e.includes(t))),{...this._def,...t})}}N=new WeakMap,Te.create=Oe;class Ie extends C{constructor(){super(...arguments),j.set(this,void 0)}_parse(e){const t=u.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==d.string&&r.parsedType!==d.number){const e=u.objectValues(t);return _(r,{expected:u.joinValues(e),received:r.parsedType,code:h.invalid_type}),E}if(I(this,j,"f")||$(this,j,new Set(u.getValidEnumValues(this._def.values)),"f"),!I(this,j,"f").has(e.data)){const e=u.objectValues(t);return _(r,{received:r.data,code:h.invalid_enum_value,options:e}),E}return S(e.data)}get enum(){return this._def.values}}j=new WeakMap,Ie.create=(e,t)=>new Ie({values:e,typeName:Be.ZodNativeEnum,...L(t)});class $e extends C{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==d.promise&&!1===t.common.async)return _(t,{code:h.invalid_type,expected:d.promise,received:t.parsedType}),E;const r=t.parsedType===d.promise?t.data:Promise.resolve(t.data);return S(r.then((e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap}))))}}$e.create=(e,t)=>new $e({type:e,typeName:Be.ZodPromise,...L(t)});class Re extends C{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Be.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:r}=this._processInputParams(e),n=this._def.effect||null,s={addIssue:e=>{_(r,e),e.fatal?t.abort():t.dirty()},get path(){return r.path}};if(s.addIssue=s.addIssue.bind(s),"preprocess"===n.type){const e=n.transform(r.data,s);if(r.common.async)return Promise.resolve(e).then((async e=>{if("aborted"===t.value)return E;const n=await this._def.schema._parseAsync({data:e,path:r.path,parent:r});return"aborted"===n.status?E:"dirty"===n.status||"dirty"===t.value?w(n.value):n}));{if("aborted"===t.value)return E;const n=this._def.schema._parseSync({data:e,path:r.path,parent:r});return"aborted"===n.status?E:"dirty"===n.status||"dirty"===t.value?w(n.value):n}}if("refinement"===n.type){const e=e=>{const t=n.refinement(e,s);if(r.common.async)return Promise.resolve(t);if(t instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1===r.common.async){const n=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===n.status?E:("dirty"===n.status&&t.dirty(),e(n.value),{status:t.value,value:n.value})}return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then((r=>"aborted"===r.status?E:("dirty"===r.status&&t.dirty(),e(r.value).then((()=>({status:t.value,value:r.value}))))))}if("transform"===n.type){if(!1===r.common.async){const e=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!O(e))return e;const i=n.transform(e.value,s);if(i instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:i}}return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then((e=>O(e)?Promise.resolve(n.transform(e.value,s)).then((e=>({status:t.value,value:e}))):e))}u.assertNever(n)}}Re.create=(e,t,r)=>new Re({schema:e,typeName:Be.ZodEffects,effect:t,...L(r)}),Re.createWithPreprocess=(e,t,r)=>new Re({schema:t,effect:{type:"preprocess",transform:e},typeName:Be.ZodEffects,...L(r)});class Ne extends C{_parse(e){return this._getType(e)===d.undefined?S(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Ne.create=(e,t)=>new Ne({innerType:e,typeName:Be.ZodOptional,...L(t)});class je extends C{_parse(e){return this._getType(e)===d.null?S(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}je.create=(e,t)=>new je({innerType:e,typeName:Be.ZodNullable,...L(t)});class Ae extends C{_parse(e){const{ctx:t}=this._processInputParams(e);let r=t.data;return t.parsedType===d.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}Ae.create=(e,t)=>new Ae({innerType:e,typeName:Be.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...L(t)});class Pe extends C{_parse(e){const{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},n=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return T(n)?n.then((e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new f(r.common.issues)},input:r.data})}))):{status:"valid",value:"valid"===n.status?n.value:this._def.catchValue({get error(){return new f(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}Pe.create=(e,t)=>new Pe({innerType:e,typeName:Be.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...L(t)});class Le extends C{_parse(e){if(this._getType(e)!==d.nan){const t=this._getOrReturnCtx(e);return _(t,{code:h.invalid_type,expected:d.nan,received:t.parsedType}),E}return{status:"valid",value:e.data}}}Le.create=e=>new Le({typeName:Be.ZodNaN,...L(e)});const Ce=Symbol("zod_brand");class Ze extends C{_parse(e){const{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class Me extends C{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.common.async){return(async()=>{const e=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?E:"dirty"===e.status?(t.dirty(),w(e.value)):this._def.out._parseAsync({data:e.value,path:r.path,parent:r})})()}{const e=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?E:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:r.path,parent:r})}}static create(e,t){return new Me({in:e,out:t,typeName:Be.ZodPipeline})}}class De extends C{_parse(e){const t=this._def.innerType._parse(e),r=e=>(O(e)&&(e.value=Object.freeze(e.value)),e);return T(t)?t.then((e=>r(e))):r(t)}unwrap(){return this._def.innerType}}function Ue(e,t={},r){return e?oe.create().superRefine(((n,s)=>{var i,a;if(!e(n)){const e="function"==typeof t?t(n):"string"==typeof t?{message:t}:t,o=null===(a=null!==(i=e.fatal)&&void 0!==i?i:r)||void 0===a||a,c="string"==typeof e?{message:e}:e;s.addIssue({code:"custom",...c,fatal:o})}})):oe.create()}De.create=(e,t)=>new De({innerType:e,typeName:Be.ZodReadonly,...L(t)});const Ve={object:he.lazycreate};var Be;!function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}(Be||(Be={}));const Ke=Y.create,Fe=ee.create,Ge=Le.create,ze=te.create,He=re.create,Xe=ne.create,We=se.create,qe=ie.create,Je=ae.create,Ye=oe.create,Qe=ce.create,et=ue.create,tt=le.create,rt=de.create,nt=he.create,st=he.strictCreate,it=fe.create,at=ye.create,ot=ge.create,ct=_e.create,ut=be.create,lt=Ee.create,dt=we.create,pt=Se.create,ht=xe.create,ft=ke.create,mt=Te.create,yt=Ie.create,vt=$e.create,gt=Re.create,_t=Ne.create,bt=je.create,Et=Re.createWithPreprocess,wt=Me.create,St={string:e=>Y.create({...e,coerce:!0}),number:e=>ee.create({...e,coerce:!0}),boolean:e=>re.create({...e,coerce:!0}),bigint:e=>te.create({...e,coerce:!0}),date:e=>ne.create({...e,coerce:!0})},xt=E;var kt=Object.freeze({__proto__:null,defaultErrorMap:m,setErrorMap:function(e){y=e},getErrorMap:v,makeIssue:g,EMPTY_PATH:[],addIssueToContext:_,ParseStatus:b,INVALID:E,DIRTY:w,OK:S,isAborted:x,isDirty:k,isValid:O,isAsync:T,get util(){return u},get objectUtil(){return l},ZodParsedType:d,getParsedType:p,ZodType:C,datetimeRegex:J,ZodString:Y,ZodNumber:ee,ZodBigInt:te,ZodBoolean:re,ZodDate:ne,ZodSymbol:se,ZodUndefined:ie,ZodNull:ae,ZodAny:oe,ZodUnknown:ce,ZodNever:ue,ZodVoid:le,ZodArray:de,ZodObject:he,ZodUnion:fe,ZodDiscriminatedUnion:ye,ZodIntersection:ge,ZodTuple:_e,ZodRecord:be,ZodMap:Ee,ZodSet:we,ZodFunction:Se,ZodLazy:xe,ZodLiteral:ke,ZodEnum:Te,ZodNativeEnum:Ie,ZodPromise:$e,ZodEffects:Re,ZodTransformer:Re,ZodOptional:Ne,ZodNullable:je,ZodDefault:Ae,ZodCatch:Pe,ZodNaN:Le,BRAND:Ce,ZodBranded:Ze,ZodPipeline:Me,ZodReadonly:De,custom:Ue,Schema:C,ZodSchema:C,late:Ve,get ZodFirstPartyTypeKind(){return Be},coerce:St,any:Ye,array:rt,bigint:ze,boolean:He,date:Xe,discriminatedUnion:at,effect:gt,enum:mt,function:pt,instanceof:(e,t={message:`Input not instance of ${e.name}`})=>Ue((t=>t instanceof e),t),intersection:ot,lazy:ht,literal:ft,map:lt,nan:Ge,nativeEnum:yt,never:et,null:Je,nullable:bt,number:Fe,object:nt,oboolean:()=>He().optional(),onumber:()=>Fe().optional(),optional:_t,ostring:()=>Ke().optional(),pipeline:wt,preprocess:Et,promise:vt,record:ut,set:dt,strictObject:st,string:Ke,symbol:We,transformer:gt,tuple:ct,undefined:qe,union:it,unknown:Qe,void:tt,NEVER:xt,ZodIssueCode:h,quotelessJson:e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:"),ZodError:f}),Ot=["interface","display","layout","module","panel","theme"],Tt=["hook","endpoint"],It=["operation"],$t="directus:extension",Rt=kt.object({app:kt.string(),api:kt.string()}),Nt=kt.object({request:kt.optional(kt.object({urls:kt.array(kt.string()),methods:kt.array(kt.union([kt.literal("GET"),kt.literal("POST"),kt.literal("PATCH"),kt.literal("PUT"),kt.literal("DELETE")]))})),log:kt.optional(kt.object({})),sleep:kt.optional(kt.object({}))}),jt=kt.optional(kt.object({enabled:kt.boolean(),requestedScopes:Nt})),At=kt.union([kt.object({type:kt.enum(Tt),name:kt.string(),source:kt.string()}),kt.object({type:kt.enum(Ot),name:kt.string(),source:kt.string()}),kt.object({type:kt.enum(It),name:kt.string(),source:Rt})]),Pt=kt.object({host:kt.string(),hidden:kt.boolean().optional()}),Lt=kt.object({type:kt.enum(Ot),path:kt.string(),source:kt.string()}),Ct=kt.object({type:kt.enum(Tt),path:kt.string(),source:kt.string(),sandbox:jt}),Zt=kt.object({type:kt.enum(It),path:Rt,source:Rt,sandbox:jt}),Mt=kt.object({type:kt.literal("bundle"),partial:kt.boolean().optional(),path:Rt,entries:kt.array(At)});kt.array(At);var Dt=Pt.and(kt.union([Lt,Ct,Zt,Mt]));kt.object({name:kt.string(),version:kt.string(),type:kt.union([kt.literal("module"),kt.literal("commonjs")]).optional(),description:kt.string().optional(),icon:kt.string().optional(),dependencies:kt.record(kt.string()).optional(),devDependencies:kt.record(kt.string()).optional(),[$t]:Dt});var Ut={},Vt={exports:{}};
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
!function(t,r){var n=e,s=n.Buffer;function i(e,t){for(var r in e)t[r]=e[r]}function a(e,t,r){return s(e,t,r)}s.from&&s.alloc&&s.allocUnsafe&&s.allocUnsafeSlow?t.exports=n:(i(n,r),r.Buffer=a),a.prototype=Object.create(s.prototype),i(s,a),a.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return s(e,t,r)},a.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=s(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},a.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return s(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}}(Vt,Vt.exports);var Bt=Vt.exports,Kt=Bt.Buffer,Ft=t;function Gt(e){if(this.buffer=null,this.writable=!0,this.readable=!0,!e)return this.buffer=Kt.alloc(0),this;if("function"==typeof e.pipe)return this.buffer=Kt.alloc(0),e.pipe(this),this;if(e.length||"object"==typeof e)return this.buffer=e,this.writable=!1,process.nextTick(function(){this.emit("end",e),this.readable=!1,this.emit("close")}.bind(this)),this;throw new TypeError("Unexpected data type ("+typeof e+")")}r.inherits(Gt,Ft),Gt.prototype.write=function(e){this.buffer=Kt.concat([this.buffer,Kt.from(e)]),this.emit("data",e)},Gt.prototype.end=function(e){e&&this.write(e),this.emit("end",e),this.emit("close"),this.writable=!1,this.readable=!1};var zt=Gt,Ht=e.Buffer,Xt=e.SlowBuffer,Wt=qt;function qt(e,t){if(!Ht.isBuffer(e)||!Ht.isBuffer(t))return!1;if(e.length!==t.length)return!1;for(var r=0,n=0;n<e.length;n++)r|=e[n]^t[n];return 0===r}qt.install=function(){Ht.prototype.equal=Xt.prototype.equal=function(e){return qt(this,e)}};var Jt=Ht.prototype.equal,Yt=Xt.prototype.equal;function Qt(e){return(e/8|0)+(e%8==0?0:1)}qt.restore=function(){Ht.prototype.equal=Jt,Xt.prototype.equal=Yt};var er={ES256:Qt(256),ES384:Qt(384),ES512:Qt(521)};var tr=function(e){var t=er[e];if(t)return t;throw new Error('Unknown algorithm "'+e+'"')},rr=Bt.Buffer,nr=tr,sr=128;function ir(e){if(rr.isBuffer(e))return e;if("string"==typeof e)return rr.from(e,"base64");throw new TypeError("ECDSA signature must be a Base64 string or a Buffer")}function ar(e,t,r){for(var n=0;t+n<r&&0===e[t+n];)++n;return e[t+n]>=sr&&--n,n}var or={derToJose:function(e,t){e=ir(e);var r=nr(t),n=r+1,s=e.length,i=0;if(48!==e[i++])throw new Error('Could not find expected "seq"');var a=e[i++];if(129===a&&(a=e[i++]),s-i<a)throw new Error('"seq" specified length of "'+a+'", only "'+(s-i)+'" remaining');if(2!==e[i++])throw new Error('Could not find expected "int" for "r"');var o=e[i++];if(s-i-2<o)throw new Error('"r" specified length of "'+o+'", only "'+(s-i-2)+'" available');if(n<o)throw new Error('"r" specified length of "'+o+'", max of "'+n+'" is acceptable');var c=i;if(i+=o,2!==e[i++])throw new Error('Could not find expected "int" for "s"');var u=e[i++];if(s-i!==u)throw new Error('"s" specified length of "'+u+'", expected "'+(s-i)+'"');if(n<u)throw new Error('"s" specified length of "'+u+'", max of "'+n+'" is acceptable');var l=i;if((i+=u)!==s)throw new Error('Expected to consume entire buffer, but "'+(s-i)+'" bytes remain');var d=r-o,p=r-u,h=rr.allocUnsafe(d+o+p+u);for(i=0;i<d;++i)h[i]=0;e.copy(h,i,c+Math.max(-d,0),c+o);for(var f=i=r;i<f+p;++i)h[i]=0;return e.copy(h,i,l+Math.max(-p,0),l+u),h=(h=h.toString("base64")).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},joseToDer:function(e,t){e=ir(e);var r=nr(t),n=e.length;if(n!==2*r)throw new TypeError('"'+t+'" signatures must be "'+2*r+'" bytes, saw "'+n+'"');var s=ar(e,0,r),i=ar(e,r,e.length),a=r-s,o=r-i,c=2+a+1+1+o,u=c<sr,l=rr.allocUnsafe((u?2:3)+c),d=0;return l[d++]=48,u?l[d++]=c:(l[d++]=129,l[d++]=255&c),l[d++]=2,l[d++]=a,s<0?(l[d++]=0,d+=e.copy(l,d,0,r)):d+=e.copy(l,d,s,r),l[d++]=2,l[d++]=o,i<0?(l[d++]=0,e.copy(l,d,r)):e.copy(l,d,r+i),l}},cr=Wt,ur=Bt.Buffer,lr=n,dr=or,pr=r,hr="secret must be a string or buffer",fr="key must be a string or a buffer",mr="function"==typeof lr.createPublicKey;function yr(e){if(!ur.isBuffer(e)&&"string"!=typeof e){if(!mr)throw br(fr);if("object"!=typeof e)throw br(fr);if("string"!=typeof e.type)throw br(fr);if("string"!=typeof e.asymmetricKeyType)throw br(fr);if("function"!=typeof e.export)throw br(fr)}}function vr(e){if(!ur.isBuffer(e)&&"string"!=typeof e&&"object"!=typeof e)throw br("key must be a string, a buffer or an object")}function gr(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function _r(e){var t=4-(e=e.toString()).length%4;if(4!==t)for(var r=0;r<t;++r)e+="=";return e.replace(/\-/g,"+").replace(/_/g,"/")}function br(e){var t=[].slice.call(arguments,1),r=pr.format.bind(pr,e).apply(null,t);return new TypeError(r)}function Er(e){var t;return t=e,ur.isBuffer(t)||"string"==typeof t||(e=JSON.stringify(e)),e}function wr(e){return function(t,r){!function(e){if(!ur.isBuffer(e)){if("string"==typeof e)return e;if(!mr)throw br(hr);if("object"!=typeof e)throw br(hr);if("secret"!==e.type)throw br(hr);if("function"!=typeof e.export)throw br(hr)}}(r),t=Er(t);var n=lr.createHmac("sha"+e,r);return gr((n.update(t),n.digest("base64")))}}function Sr(e){return function(t,r,n){var s=wr(e)(t,n);return cr(ur.from(r),ur.from(s))}}function xr(e){return function(t,r){vr(r),t=Er(t);var n=lr.createSign("RSA-SHA"+e);return gr((n.update(t),n.sign(r,"base64")))}}function kr(e){return function(t,r,n){yr(n),t=Er(t),r=_r(r);var s=lr.createVerify("RSA-SHA"+e);return s.update(t),s.verify(n,r,"base64")}}function Or(e){return function(t,r){vr(r),t=Er(t);var n=lr.createSign("RSA-SHA"+e);return gr((n.update(t),n.sign({key:r,padding:lr.constants.RSA_PKCS1_PSS_PADDING,saltLength:lr.constants.RSA_PSS_SALTLEN_DIGEST},"base64")))}}function Tr(e){return function(t,r,n){yr(n),t=Er(t),r=_r(r);var s=lr.createVerify("RSA-SHA"+e);return s.update(t),s.verify({key:n,padding:lr.constants.RSA_PKCS1_PSS_PADDING,saltLength:lr.constants.RSA_PSS_SALTLEN_DIGEST},r,"base64")}}function Ir(e){var t=xr(e);return function(){var r=t.apply(null,arguments);return r=dr.derToJose(r,"ES"+e)}}function $r(e){var t=kr(e);return function(r,n,s){return n=dr.joseToDer(n,"ES"+e).toString("base64"),t(r,n,s)}}function Rr(){return function(){return""}}function Nr(){return function(e,t){return""===t}}mr&&(fr+=" or a KeyObject",hr+="or a KeyObject");var jr=function(e){var t={hs:wr,rs:xr,ps:Or,es:Ir,none:Rr},r={hs:Sr,rs:kr,ps:Tr,es:$r,none:Nr},n=e.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/i);if(!n)throw br('"%s" is not a valid algorithm.\n  Supported algorithms are:\n  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".',e);var s=(n[1]||n[3]).toLowerCase(),i=n[2];return{sign:t[s](i),verify:r[s](i)}},Ar=e.Buffer,Pr=function(e){return"string"==typeof e?e:"number"==typeof e||Ar.isBuffer(e)?e.toString():JSON.stringify(e)},Lr=Bt.Buffer,Cr=zt,Zr=jr,Mr=t,Dr=Pr,Ur=r;function Vr(e,t){return Lr.from(e,t).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Br(e){var t=e.header,r=e.payload,n=e.secret||e.privateKey,s=e.encoding,i=Zr(t.alg),a=function(e,t,r){r=r||"utf8";var n=Vr(Dr(e),"binary"),s=Vr(Dr(t),r);return Ur.format("%s.%s",n,s)}(t,r,s),o=i.sign(a,n);return Ur.format("%s.%s",a,o)}function Kr(e){var t=e.secret||e.privateKey||e.key,r=new Cr(t);this.readable=!0,this.header=e.header,this.encoding=e.encoding,this.secret=this.privateKey=this.key=r,this.payload=new Cr(e.payload),this.secret.once("close",function(){!this.payload.writable&&this.readable&&this.sign()}.bind(this)),this.payload.once("close",function(){!this.secret.writable&&this.readable&&this.sign()}.bind(this))}Ur.inherits(Kr,Mr),Kr.prototype.sign=function(){try{var e=Br({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",e),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(e){this.readable=!1,this.emit("error",e),this.emit("close")}},Kr.sign=Br;var Fr=Kr,Gr=Bt.Buffer,zr=zt,Hr=jr,Xr=t,Wr=Pr,qr=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function Jr(e){if(function(e){return"[object Object]"===Object.prototype.toString.call(e)}(e))return e;try{return JSON.parse(e)}catch(e){return}}function Yr(e){var t=e.split(".",1)[0];return Jr(Gr.from(t,"base64").toString("binary"))}function Qr(e){return e.split(".")[2]}function en(e){return qr.test(e)&&!!Yr(e)}function tn(e,t,r){if(!t){var n=new Error("Missing algorithm parameter for jws.verify");throw n.code="MISSING_ALGORITHM",n}var s=Qr(e=Wr(e)),i=function(e){return e.split(".",2).join(".")}(e);return Hr(t).verify(i,s,r)}function rn(e,t){if(t=t||{},!en(e=Wr(e)))return null;var r=Yr(e);if(!r)return null;var n=function(e,t){t=t||"utf8";var r=e.split(".")[1];return Gr.from(r,"base64").toString(t)}(e);return("JWT"===r.typ||t.json)&&(n=JSON.parse(n,t.encoding)),{header:r,payload:n,signature:Qr(e)}}function nn(e){var t=(e=e||{}).secret||e.publicKey||e.key,r=new zr(t);this.readable=!0,this.algorithm=e.algorithm,this.encoding=e.encoding,this.secret=this.publicKey=this.key=r,this.signature=new zr(e.signature),this.secret.once("close",function(){!this.signature.writable&&this.readable&&this.verify()}.bind(this)),this.signature.once("close",function(){!this.secret.writable&&this.readable&&this.verify()}.bind(this))}r.inherits(nn,Xr),nn.prototype.verify=function(){try{var e=tn(this.signature.buffer,this.algorithm,this.key.buffer),t=rn(this.signature.buffer,this.encoding);return this.emit("done",e,t),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(e){this.readable=!1,this.emit("error",e),this.emit("close")}},nn.decode=rn,nn.isValid=en,nn.verify=tn;var sn=Fr,an=nn;Ut.ALGORITHMS=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"],Ut.sign=sn.sign,Ut.verify=an.verify,Ut.decode=an.decode,Ut.isValid=an.isValid,Ut.createSign=function(e){return new sn(e)},Ut.createVerify=function(e){return new an(e)};var on=Ut,cn=function(e,t){t=t||{};var r=on.decode(e,t);if(!r)return null;var n=r.payload;if("string"==typeof n)try{var s=JSON.parse(n);null!==s&&"object"==typeof s&&(n=s)}catch(e){}return!0===t.complete?{header:r.header,payload:n,signature:r.signature}:n},un=function(e,t){Error.call(this,e),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="JsonWebTokenError",this.message=e,t&&(this.inner=t)};(un.prototype=Object.create(Error.prototype)).constructor=un;var ln=un,dn=ln,pn=function(e,t){dn.call(this,e),this.name="NotBeforeError",this.date=t};(pn.prototype=Object.create(dn.prototype)).constructor=pn;var hn=pn,fn=ln,mn=function(e,t){fn.call(this,e),this.name="TokenExpiredError",this.expiredAt=t};(mn.prototype=Object.create(fn.prototype)).constructor=mn;var yn=mn,vn=1e3,gn=60*vn,_n=60*gn,bn=24*_n,En=7*bn,wn=365.25*bn,Sn=function(e,t){t=t||{};var r=typeof e;if("string"===r&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var r=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return r*wn;case"weeks":case"week":case"w":return r*En;case"days":case"day":case"d":return r*bn;case"hours":case"hour":case"hrs":case"hr":case"h":return r*_n;case"minutes":case"minute":case"mins":case"min":case"m":return r*gn;case"seconds":case"second":case"secs":case"sec":case"s":return r*vn;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}(e);if("number"===r&&isFinite(e))return t.long?function(e){var t=Math.abs(e);if(t>=bn)return xn(e,t,bn,"day");if(t>=_n)return xn(e,t,_n,"hour");if(t>=gn)return xn(e,t,gn,"minute");if(t>=vn)return xn(e,t,vn,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=bn)return Math.round(e/bn)+"d";if(t>=_n)return Math.round(e/_n)+"h";if(t>=gn)return Math.round(e/gn)+"m";if(t>=vn)return Math.round(e/vn)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function xn(e,t,r,n){var s=t>=1.5*r;return Math.round(e/r)+" "+n+(s?"s":"")}var kn=c(Sn),On=Sn,Tn=function(e,t){var r=t||Math.floor(Date.now()/1e3);if("string"==typeof e){var n=On(e);if(void 0===n)return;return Math.floor(r+n/1e3)}return"number"==typeof e?r+e:void 0},In={exports:{}};var $n={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2};var Rn="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};!function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:n,MAX_LENGTH:s}=$n,i=Rn,a=(t=e.exports={}).re=[],o=t.safeRe=[],c=t.src=[],u=t.t={};let l=0;const d="[a-zA-Z0-9-]",p=[["\\s",1],["\\d",s],[d,n]],h=(e,t,r)=>{const n=(e=>{for(const[t,r]of p)e=e.split(`${t}*`).join(`${t}{0,${r}}`).split(`${t}+`).join(`${t}{1,${r}}`);return e})(t),s=l++;i(e,s,t),u[e]=s,c[s]=t,a[s]=new RegExp(t,r?"g":void 0),o[s]=new RegExp(n,r?"g":void 0)};h("NUMERICIDENTIFIER","0|[1-9]\\d*"),h("NUMERICIDENTIFIERLOOSE","\\d+"),h("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${d}*`),h("MAINVERSION",`(${c[u.NUMERICIDENTIFIER]})\\.(${c[u.NUMERICIDENTIFIER]})\\.(${c[u.NUMERICIDENTIFIER]})`),h("MAINVERSIONLOOSE",`(${c[u.NUMERICIDENTIFIERLOOSE]})\\.(${c[u.NUMERICIDENTIFIERLOOSE]})\\.(${c[u.NUMERICIDENTIFIERLOOSE]})`),h("PRERELEASEIDENTIFIER",`(?:${c[u.NUMERICIDENTIFIER]}|${c[u.NONNUMERICIDENTIFIER]})`),h("PRERELEASEIDENTIFIERLOOSE",`(?:${c[u.NUMERICIDENTIFIERLOOSE]}|${c[u.NONNUMERICIDENTIFIER]})`),h("PRERELEASE",`(?:-(${c[u.PRERELEASEIDENTIFIER]}(?:\\.${c[u.PRERELEASEIDENTIFIER]})*))`),h("PRERELEASELOOSE",`(?:-?(${c[u.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${c[u.PRERELEASEIDENTIFIERLOOSE]})*))`),h("BUILDIDENTIFIER",`${d}+`),h("BUILD",`(?:\\+(${c[u.BUILDIDENTIFIER]}(?:\\.${c[u.BUILDIDENTIFIER]})*))`),h("FULLPLAIN",`v?${c[u.MAINVERSION]}${c[u.PRERELEASE]}?${c[u.BUILD]}?`),h("FULL",`^${c[u.FULLPLAIN]}$`),h("LOOSEPLAIN",`[v=\\s]*${c[u.MAINVERSIONLOOSE]}${c[u.PRERELEASELOOSE]}?${c[u.BUILD]}?`),h("LOOSE",`^${c[u.LOOSEPLAIN]}$`),h("GTLT","((?:<|>)?=?)"),h("XRANGEIDENTIFIERLOOSE",`${c[u.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),h("XRANGEIDENTIFIER",`${c[u.NUMERICIDENTIFIER]}|x|X|\\*`),h("XRANGEPLAIN",`[v=\\s]*(${c[u.XRANGEIDENTIFIER]})(?:\\.(${c[u.XRANGEIDENTIFIER]})(?:\\.(${c[u.XRANGEIDENTIFIER]})(?:${c[u.PRERELEASE]})?${c[u.BUILD]}?)?)?`),h("XRANGEPLAINLOOSE",`[v=\\s]*(${c[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[u.XRANGEIDENTIFIERLOOSE]})(?:${c[u.PRERELEASELOOSE]})?${c[u.BUILD]}?)?)?`),h("XRANGE",`^${c[u.GTLT]}\\s*${c[u.XRANGEPLAIN]}$`),h("XRANGELOOSE",`^${c[u.GTLT]}\\s*${c[u.XRANGEPLAINLOOSE]}$`),h("COERCEPLAIN",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?`),h("COERCE",`${c[u.COERCEPLAIN]}(?:$|[^\\d])`),h("COERCEFULL",c[u.COERCEPLAIN]+`(?:${c[u.PRERELEASE]})?`+`(?:${c[u.BUILD]})?(?:$|[^\\d])`),h("COERCERTL",c[u.COERCE],!0),h("COERCERTLFULL",c[u.COERCEFULL],!0),h("LONETILDE","(?:~>?)"),h("TILDETRIM",`(\\s*)${c[u.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",h("TILDE",`^${c[u.LONETILDE]}${c[u.XRANGEPLAIN]}$`),h("TILDELOOSE",`^${c[u.LONETILDE]}${c[u.XRANGEPLAINLOOSE]}$`),h("LONECARET","(?:\\^)"),h("CARETTRIM",`(\\s*)${c[u.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",h("CARET",`^${c[u.LONECARET]}${c[u.XRANGEPLAIN]}$`),h("CARETLOOSE",`^${c[u.LONECARET]}${c[u.XRANGEPLAINLOOSE]}$`),h("COMPARATORLOOSE",`^${c[u.GTLT]}\\s*(${c[u.LOOSEPLAIN]})$|^$`),h("COMPARATOR",`^${c[u.GTLT]}\\s*(${c[u.FULLPLAIN]})$|^$`),h("COMPARATORTRIM",`(\\s*)${c[u.GTLT]}\\s*(${c[u.LOOSEPLAIN]}|${c[u.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",h("HYPHENRANGE",`^\\s*(${c[u.XRANGEPLAIN]})\\s+-\\s+(${c[u.XRANGEPLAIN]})\\s*$`),h("HYPHENRANGELOOSE",`^\\s*(${c[u.XRANGEPLAINLOOSE]})\\s+-\\s+(${c[u.XRANGEPLAINLOOSE]})\\s*$`),h("STAR","(<|>)?=?\\s*\\*"),h("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),h("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(In,In.exports);var Nn=In.exports;const jn=Object.freeze({loose:!0}),An=Object.freeze({});var Pn=e=>e?"object"!=typeof e?jn:e:An;const Ln=/^[0-9]+$/,Cn=(e,t)=>{const r=Ln.test(e),n=Ln.test(t);return r&&n&&(e=+e,t=+t),e===t?0:r&&!n?-1:n&&!r?1:e<t?-1:1};var Zn={compareIdentifiers:Cn,rcompareIdentifiers:(e,t)=>Cn(t,e)};const Mn=Rn,{MAX_LENGTH:Dn,MAX_SAFE_INTEGER:Un}=$n,{safeRe:Vn,t:Bn}=Nn,Kn=Pn,{compareIdentifiers:Fn}=Zn;var Gn=class e{constructor(t,r){if(r=Kn(r),t instanceof e){if(t.loose===!!r.loose&&t.includePrerelease===!!r.includePrerelease)return t;t=t.version}else if("string"!=typeof t)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof t}".`);if(t.length>Dn)throw new TypeError(`version is longer than ${Dn} characters`);Mn("SemVer",t,r),this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease;const n=t.trim().match(r.loose?Vn[Bn.LOOSE]:Vn[Bn.FULL]);if(!n)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>Un||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Un||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Un||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<Un)return t}return e})):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(Mn("SemVer.compare",this.version,this.options,t),!(t instanceof e)){if("string"==typeof t&&t===this.version)return 0;t=new e(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof e||(t=new e(t,this.options)),Fn(this.major,t.major)||Fn(this.minor,t.minor)||Fn(this.patch,t.patch)}comparePre(t){if(t instanceof e||(t=new e(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let r=0;do{const e=this.prerelease[r],n=t.prerelease[r];if(Mn("prerelease compare",r,e,n),void 0===e&&void 0===n)return 0;if(void 0===n)return 1;if(void 0===e)return-1;if(e!==n)return Fn(e,n)}while(++r)}compareBuild(t){t instanceof e||(t=new e(t,this.options));let r=0;do{const e=this.build[r],n=t.build[r];if(Mn("build compare",r,e,n),void 0===e&&void 0===n)return 0;if(void 0===n)return 1;if(void 0===e)return-1;if(e!==n)return Fn(e,n)}while(++r)}inc(e,t,r){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,r),this.inc("pre",t,r);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,r),this.inc("pre",t,r);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(r)?1:0;if(!t&&!1===r)throw new Error("invalid increment argument: identifier is empty");if(0===this.prerelease.length)this.prerelease=[e];else{let n=this.prerelease.length;for(;--n>=0;)"number"==typeof this.prerelease[n]&&(this.prerelease[n]++,n=-2);if(-1===n){if(t===this.prerelease.join(".")&&!1===r)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let n=[t,e];!1===r&&(n=[t]),0===Fn(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=n):this.prerelease=n}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};const zn=Gn;var Hn=(e,t,r=!1)=>{if(e instanceof zn)return e;try{return new zn(e,t)}catch(e){if(!r)return null;throw e}};const Xn=Hn;var Wn=(e,t)=>{const r=Xn(e,t);return r?r.version:null};const qn=Hn;var Jn=(e,t)=>{const r=qn(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null};const Yn=Gn;var Qn=(e,t,r,n,s)=>{"string"==typeof r&&(s=n,n=r,r=void 0);try{return new Yn(e instanceof Yn?e.version:e,r).inc(t,n,s).version}catch(e){return null}};const es=Hn;var ts=(e,t)=>{const r=es(e,null,!0),n=es(t,null,!0),s=r.compare(n);if(0===s)return null;const i=s>0,a=i?r:n,o=i?n:r,c=!!a.prerelease.length;if(!!o.prerelease.length&&!c)return o.patch||o.minor?a.patch?"patch":a.minor?"minor":"major":"major";const u=c?"pre":"";return r.major!==n.major?u+"major":r.minor!==n.minor?u+"minor":r.patch!==n.patch?u+"patch":"prerelease"};const rs=Gn;var ns=(e,t)=>new rs(e,t).major;const ss=Gn;var is=(e,t)=>new ss(e,t).minor;const as=Gn;var os=(e,t)=>new as(e,t).patch;const cs=Hn;var us=(e,t)=>{const r=cs(e,t);return r&&r.prerelease.length?r.prerelease:null};const ls=Gn;var ds=(e,t,r)=>new ls(e,r).compare(new ls(t,r));const ps=ds;var hs=(e,t,r)=>ps(t,e,r);const fs=ds;var ms=(e,t)=>fs(e,t,!0);const ys=Gn;var vs=(e,t,r)=>{const n=new ys(e,r),s=new ys(t,r);return n.compare(s)||n.compareBuild(s)};const gs=vs;var _s=(e,t)=>e.sort(((e,r)=>gs(e,r,t)));const bs=vs;var Es=(e,t)=>e.sort(((e,r)=>bs(r,e,t)));const ws=ds;var Ss=(e,t,r)=>ws(e,t,r)>0;const xs=ds;var ks=(e,t,r)=>xs(e,t,r)<0;const Os=ds;var Ts=(e,t,r)=>0===Os(e,t,r);const Is=ds;var $s=(e,t,r)=>0!==Is(e,t,r);const Rs=ds;var Ns=(e,t,r)=>Rs(e,t,r)>=0;const js=ds;var As=(e,t,r)=>js(e,t,r)<=0;const Ps=Ts,Ls=$s,Cs=Ss,Zs=Ns,Ms=ks,Ds=As;var Us=(e,t,r,n)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e===r;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e!==r;case"":case"=":case"==":return Ps(e,r,n);case"!=":return Ls(e,r,n);case">":return Cs(e,r,n);case">=":return Zs(e,r,n);case"<":return Ms(e,r,n);case"<=":return Ds(e,r,n);default:throw new TypeError(`Invalid operator: ${t}`)}};const Vs=Gn,Bs=Hn,{safeRe:Ks,t:Fs}=Nn;var Gs=(e,t)=>{if(e instanceof Vs)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let r=null;if((t=t||{}).rtl){const n=t.includePrerelease?Ks[Fs.COERCERTLFULL]:Ks[Fs.COERCERTL];let s;for(;(s=n.exec(e))&&(!r||r.index+r[0].length!==e.length);)r&&s.index+s[0].length===r.index+r[0].length||(r=s),n.lastIndex=s.index+s[1].length+s[2].length;n.lastIndex=-1}else r=e.match(t.includePrerelease?Ks[Fs.COERCEFULL]:Ks[Fs.COERCE]);if(null===r)return null;const n=r[2],s=r[3]||"0",i=r[4]||"0",a=t.includePrerelease&&r[5]?`-${r[5]}`:"",o=t.includePrerelease&&r[6]?`+${r[6]}`:"";return Bs(`${n}.${s}.${i}${a}${o}`,t)};var zs,Hs,Xs,Ws,qs=class{constructor(){this.max=1e3,this.map=new Map}get(e){const t=this.map.get(e);return void 0===t?void 0:(this.map.delete(e),this.map.set(e,t),t)}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&void 0!==t){if(this.map.size>=this.max){const e=this.map.keys().next().value;this.delete(e)}this.map.set(e,t)}return this}};function Js(){if(Hs)return zs;Hs=1;const e=/\s+/g;class t{constructor(r,i){if(i=n(i),r instanceof t)return r.loose===!!i.loose&&r.includePrerelease===!!i.includePrerelease?r:new t(r.raw,i);if(r instanceof s)return this.raw=r.value,this.set=[[r]],this.formatted=void 0,this;if(this.options=i,this.loose=!!i.loose,this.includePrerelease=!!i.includePrerelease,this.raw=r.trim().replace(e," "),this.set=this.raw.split("||").map((e=>this.parseRange(e.trim()))).filter((e=>e.length)),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter((e=>!f(e[0]))),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&m(e[0])){this.set=[e];break}}this.formatted=void 0}get range(){if(void 0===this.formatted){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");const t=this.set[e];for(let e=0;e<t.length;e++)e>0&&(this.formatted+=" "),this.formatted+=t[e].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){const t=((this.options.includePrerelease&&p)|(this.options.loose&&h))+":"+e,n=r.get(t);if(n)return n;const a=this.options.loose,m=a?o[c.HYPHENRANGELOOSE]:o[c.HYPHENRANGE];e=e.replace(m,T(this.options.includePrerelease)),i("hyphen replace",e),e=e.replace(o[c.COMPARATORTRIM],u),i("comparator trim",e),e=e.replace(o[c.TILDETRIM],l),i("tilde trim",e),e=e.replace(o[c.CARETTRIM],d),i("caret trim",e);let y=e.split(" ").map((e=>v(e,this.options))).join(" ").split(/\s+/).map((e=>O(e,this.options)));a&&(y=y.filter((e=>(i("loose invalid filter",e,this.options),!!e.match(o[c.COMPARATORLOOSE]))))),i("range list",y);const g=new Map,_=y.map((e=>new s(e,this.options)));for(const e of _){if(f(e))return[e];g.set(e.value,e)}g.size>1&&g.has("")&&g.delete("");const b=[...g.values()];return r.set(t,b),b}intersects(e,r){if(!(e instanceof t))throw new TypeError("a Range is required");return this.set.some((t=>y(t,r)&&e.set.some((e=>y(e,r)&&t.every((t=>e.every((e=>t.intersects(e,r)))))))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new a(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(I(this.set[t],e,this.options))return!0;return!1}}zs=t;const r=new qs,n=Pn,s=Ys(),i=Rn,a=Gn,{safeRe:o,t:c,comparatorTrimReplace:u,tildeTrimReplace:l,caretTrimReplace:d}=Nn,{FLAG_INCLUDE_PRERELEASE:p,FLAG_LOOSE:h}=$n,f=e=>"<0.0.0-0"===e.value,m=e=>""===e.value,y=(e,t)=>{let r=!0;const n=e.slice();let s=n.pop();for(;r&&n.length;)r=n.every((e=>s.intersects(e,t))),s=n.pop();return r},v=(e,t)=>(i("comp",e,t),e=E(e,t),i("caret",e),e=_(e,t),i("tildes",e),e=S(e,t),i("xrange",e),e=k(e,t),i("stars",e),e),g=e=>!e||"x"===e.toLowerCase()||"*"===e,_=(e,t)=>e.trim().split(/\s+/).map((e=>b(e,t))).join(" "),b=(e,t)=>{const r=t.loose?o[c.TILDELOOSE]:o[c.TILDE];return e.replace(r,((t,r,n,s,a)=>{let o;return i("tilde",e,t,r,n,s,a),g(r)?o="":g(n)?o=`>=${r}.0.0 <${+r+1}.0.0-0`:g(s)?o=`>=${r}.${n}.0 <${r}.${+n+1}.0-0`:a?(i("replaceTilde pr",a),o=`>=${r}.${n}.${s}-${a} <${r}.${+n+1}.0-0`):o=`>=${r}.${n}.${s} <${r}.${+n+1}.0-0`,i("tilde return",o),o}))},E=(e,t)=>e.trim().split(/\s+/).map((e=>w(e,t))).join(" "),w=(e,t)=>{i("caret",e,t);const r=t.loose?o[c.CARETLOOSE]:o[c.CARET],n=t.includePrerelease?"-0":"";return e.replace(r,((t,r,s,a,o)=>{let c;return i("caret",e,t,r,s,a,o),g(r)?c="":g(s)?c=`>=${r}.0.0${n} <${+r+1}.0.0-0`:g(a)?c="0"===r?`>=${r}.${s}.0${n} <${r}.${+s+1}.0-0`:`>=${r}.${s}.0${n} <${+r+1}.0.0-0`:o?(i("replaceCaret pr",o),c="0"===r?"0"===s?`>=${r}.${s}.${a}-${o} <${r}.${s}.${+a+1}-0`:`>=${r}.${s}.${a}-${o} <${r}.${+s+1}.0-0`:`>=${r}.${s}.${a}-${o} <${+r+1}.0.0-0`):(i("no pr"),c="0"===r?"0"===s?`>=${r}.${s}.${a}${n} <${r}.${s}.${+a+1}-0`:`>=${r}.${s}.${a}${n} <${r}.${+s+1}.0-0`:`>=${r}.${s}.${a} <${+r+1}.0.0-0`),i("caret return",c),c}))},S=(e,t)=>(i("replaceXRanges",e,t),e.split(/\s+/).map((e=>x(e,t))).join(" ")),x=(e,t)=>{e=e.trim();const r=t.loose?o[c.XRANGELOOSE]:o[c.XRANGE];return e.replace(r,((r,n,s,a,o,c)=>{i("xRange",e,r,n,s,a,o,c);const u=g(s),l=u||g(a),d=l||g(o),p=d;return"="===n&&p&&(n=""),c=t.includePrerelease?"-0":"",u?r=">"===n||"<"===n?"<0.0.0-0":"*":n&&p?(l&&(a=0),o=0,">"===n?(n=">=",l?(s=+s+1,a=0,o=0):(a=+a+1,o=0)):"<="===n&&(n="<",l?s=+s+1:a=+a+1),"<"===n&&(c="-0"),r=`${n+s}.${a}.${o}${c}`):l?r=`>=${s}.0.0${c} <${+s+1}.0.0-0`:d&&(r=`>=${s}.${a}.0${c} <${s}.${+a+1}.0-0`),i("xRange return",r),r}))},k=(e,t)=>(i("replaceStars",e,t),e.trim().replace(o[c.STAR],"")),O=(e,t)=>(i("replaceGTE0",e,t),e.trim().replace(o[t.includePrerelease?c.GTE0PRE:c.GTE0],"")),T=e=>(t,r,n,s,i,a,o,c,u,l,d,p)=>`${r=g(n)?"":g(s)?`>=${n}.0.0${e?"-0":""}`:g(i)?`>=${n}.${s}.0${e?"-0":""}`:a?`>=${r}`:`>=${r}${e?"-0":""}`} ${c=g(u)?"":g(l)?`<${+u+1}.0.0-0`:g(d)?`<${u}.${+l+1}.0-0`:p?`<=${u}.${l}.${d}-${p}`:e?`<${u}.${l}.${+d+1}-0`:`<=${c}`}`.trim(),I=(e,t,r)=>{for(let r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(let r=0;r<e.length;r++)if(i(e[r].semver),e[r].semver!==s.ANY&&e[r].semver.prerelease.length>0){const n=e[r].semver;if(n.major===t.major&&n.minor===t.minor&&n.patch===t.patch)return!0}return!1}return!0};return zs}function Ys(){if(Ws)return Xs;Ws=1;const e=Symbol("SemVer ANY");class t{static get ANY(){return e}constructor(n,s){if(s=r(s),n instanceof t){if(n.loose===!!s.loose)return n;n=n.value}n=n.trim().split(/\s+/).join(" "),a("comparator",n,s),this.options=s,this.loose=!!s.loose,this.parse(n),this.semver===e?this.value="":this.value=this.operator+this.semver.version,a("comp",this)}parse(t){const r=this.options.loose?n[s.COMPARATORLOOSE]:n[s.COMPARATOR],i=t.match(r);if(!i)throw new TypeError(`Invalid comparator: ${t}`);this.operator=void 0!==i[1]?i[1]:"","="===this.operator&&(this.operator=""),i[2]?this.semver=new o(i[2],this.options.loose):this.semver=e}toString(){return this.value}test(t){if(a("Comparator.test",t,this.options.loose),this.semver===e||t===e)return!0;if("string"==typeof t)try{t=new o(t,this.options)}catch(e){return!1}return i(t,this.operator,this.semver,this.options)}intersects(e,n){if(!(e instanceof t))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new c(e.value,n).test(this.value):""===e.operator?""===e.value||new c(this.value,n).test(e.semver):(!(n=r(n)).includePrerelease||"<0.0.0-0"!==this.value&&"<0.0.0-0"!==e.value)&&(!(!n.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0")))&&(!(!this.operator.startsWith(">")||!e.operator.startsWith(">"))||(!(!this.operator.startsWith("<")||!e.operator.startsWith("<"))||(!(this.semver.version!==e.semver.version||!this.operator.includes("=")||!e.operator.includes("="))||(!!(i(this.semver,"<",e.semver,n)&&this.operator.startsWith(">")&&e.operator.startsWith("<"))||!!(i(this.semver,">",e.semver,n)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))))))}}Xs=t;const r=Pn,{safeRe:n,t:s}=Nn,i=Us,a=Rn,o=Gn,c=Js();return Xs}const Qs=Js();var ei=(e,t,r)=>{try{t=new Qs(t,r)}catch(e){return!1}return t.test(e)};const ti=Js();var ri=(e,t)=>new ti(e,t).set.map((e=>e.map((e=>e.value)).join(" ").trim().split(" ")));const ni=Gn,si=Js();var ii=(e,t,r)=>{let n=null,s=null,i=null;try{i=new si(t,r)}catch(e){return null}return e.forEach((e=>{i.test(e)&&(n&&-1!==s.compare(e)||(n=e,s=new ni(n,r)))})),n};const ai=Gn,oi=Js();var ci=(e,t,r)=>{let n=null,s=null,i=null;try{i=new oi(t,r)}catch(e){return null}return e.forEach((e=>{i.test(e)&&(n&&1!==s.compare(e)||(n=e,s=new ai(n,r)))})),n};const ui=Gn,li=Js(),di=Ss;var pi=(e,t)=>{e=new li(e,t);let r=new ui("0.0.0");if(e.test(r))return r;if(r=new ui("0.0.0-0"),e.test(r))return r;r=null;for(let t=0;t<e.set.length;++t){const n=e.set[t];let s=null;n.forEach((e=>{const t=new ui(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":s&&!di(t,s)||(s=t);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${e.operator}`)}})),!s||r&&!di(r,s)||(r=s)}return r&&e.test(r)?r:null};const hi=Js();var fi=(e,t)=>{try{return new hi(e,t).range||"*"}catch(e){return null}};const mi=Gn,yi=Ys(),{ANY:vi}=yi,gi=Js(),_i=ei,bi=Ss,Ei=ks,wi=As,Si=Ns;var xi=(e,t,r,n)=>{let s,i,a,o,c;switch(e=new mi(e,n),t=new gi(t,n),r){case">":s=bi,i=wi,a=Ei,o=">",c=">=";break;case"<":s=Ei,i=Si,a=bi,o="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(_i(e,t,n))return!1;for(let r=0;r<t.set.length;++r){const u=t.set[r];let l=null,d=null;if(u.forEach((e=>{e.semver===vi&&(e=new yi(">=0.0.0")),l=l||e,d=d||e,s(e.semver,l.semver,n)?l=e:a(e.semver,d.semver,n)&&(d=e)})),l.operator===o||l.operator===c)return!1;if((!d.operator||d.operator===o)&&i(e,d.semver))return!1;if(d.operator===c&&a(e,d.semver))return!1}return!0};const ki=xi;var Oi=(e,t,r)=>ki(e,t,">",r);const Ti=xi;var Ii=(e,t,r)=>Ti(e,t,"<",r);const $i=Js();var Ri=(e,t,r)=>(e=new $i(e,r),t=new $i(t,r),e.intersects(t,r));const Ni=ei,ji=ds;const Ai=Js(),Pi=Ys(),{ANY:Li}=Pi,Ci=ei,Zi=ds,Mi=[new Pi(">=0.0.0-0")],Di=[new Pi(">=0.0.0")],Ui=(e,t,r)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===Li){if(1===t.length&&t[0].semver===Li)return!0;e=r.includePrerelease?Mi:Di}if(1===t.length&&t[0].semver===Li){if(r.includePrerelease)return!0;t=Di}const n=new Set;let s,i,a,o,c,u,l;for(const t of e)">"===t.operator||">="===t.operator?s=Vi(s,t,r):"<"===t.operator||"<="===t.operator?i=Bi(i,t,r):n.add(t.semver);if(n.size>1)return null;if(s&&i){if(a=Zi(s.semver,i.semver,r),a>0)return null;if(0===a&&(">="!==s.operator||"<="!==i.operator))return null}for(const e of n){if(s&&!Ci(e,String(s),r))return null;if(i&&!Ci(e,String(i),r))return null;for(const n of t)if(!Ci(e,String(n),r))return!1;return!0}let d=!(!i||r.includePrerelease||!i.semver.prerelease.length)&&i.semver,p=!(!s||r.includePrerelease||!s.semver.prerelease.length)&&s.semver;d&&1===d.prerelease.length&&"<"===i.operator&&0===d.prerelease[0]&&(d=!1);for(const e of t){if(l=l||">"===e.operator||">="===e.operator,u=u||"<"===e.operator||"<="===e.operator,s)if(p&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===p.major&&e.semver.minor===p.minor&&e.semver.patch===p.patch&&(p=!1),">"===e.operator||">="===e.operator){if(o=Vi(s,e,r),o===e&&o!==s)return!1}else if(">="===s.operator&&!Ci(s.semver,String(e),r))return!1;if(i)if(d&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===d.major&&e.semver.minor===d.minor&&e.semver.patch===d.patch&&(d=!1),"<"===e.operator||"<="===e.operator){if(c=Bi(i,e,r),c===e&&c!==i)return!1}else if("<="===i.operator&&!Ci(i.semver,String(e),r))return!1;if(!e.operator&&(i||s)&&0!==a)return!1}return!(s&&u&&!i&&0!==a)&&(!(i&&l&&!s&&0!==a)&&(!p&&!d))},Vi=(e,t,r)=>{if(!e)return t;const n=Zi(e.semver,t.semver,r);return n>0?e:n<0||">"===t.operator&&">="===e.operator?t:e},Bi=(e,t,r)=>{if(!e)return t;const n=Zi(e.semver,t.semver,r);return n<0?e:n>0||"<"===t.operator&&"<="===e.operator?t:e};var Ki=(e,t,r={})=>{if(e===t)return!0;e=new Ai(e,r),t=new Ai(t,r);let n=!1;e:for(const s of e.set){for(const e of t.set){const t=Ui(s,e,r);if(n=n||null!==t,t)continue e}if(n)return!1}return!0};const Fi=Nn,Gi=$n,zi=Gn,Hi=Zn,Xi=(e,t,r)=>{const n=[];let s=null,i=null;const a=e.sort(((e,t)=>ji(e,t,r)));for(const e of a){Ni(e,t,r)?(i=e,s||(s=e)):(i&&n.push([s,i]),i=null,s=null)}s&&n.push([s,null]);const o=[];for(const[e,t]of n)e===t?o.push(e):t||e!==a[0]?t?e===a[0]?o.push(`<=${t}`):o.push(`${e} - ${t}`):o.push(`>=${e}`):o.push("*");const c=o.join(" || "),u="string"==typeof t.raw?t.raw:String(t);return c.length<u.length?c:t};var Wi={parse:Hn,valid:Wn,clean:Jn,inc:Qn,diff:ts,major:ns,minor:is,patch:os,prerelease:us,compare:ds,rcompare:hs,compareLoose:ms,compareBuild:vs,sort:_s,rsort:Es,gt:Ss,lt:ks,eq:Ts,neq:$s,gte:Ns,lte:As,cmp:Us,coerce:Gs,Comparator:Ys(),Range:Js(),satisfies:ei,toComparators:ri,maxSatisfying:ii,minSatisfying:ci,minVersion:pi,validRange:fi,outside:xi,gtr:Oi,ltr:Ii,intersects:Ri,simplifyRange:Xi,subset:Ki,SemVer:zi,re:Fi.re,src:Fi.src,tokens:Fi.t,SEMVER_SPEC_VERSION:Gi.SEMVER_SPEC_VERSION,RELEASE_TYPES:Gi.RELEASE_TYPES,compareIdentifiers:Hi.compareIdentifiers,rcompareIdentifiers:Hi.rcompareIdentifiers};var qi=Wi.satisfies(process.version,">=15.7.0");var Ji=Wi.satisfies(process.version,">=16.9.0");const Yi=qi,Qi=Ji,ea={ec:["ES256","ES384","ES512"],rsa:["RS256","PS256","RS384","PS384","RS512","PS512"],"rsa-pss":["PS256","PS384","PS512"]},ta={ES256:"prime256v1",ES384:"secp384r1",ES512:"secp521r1"};var ra=function(e,t){if(!e||!t)return;const r=t.asymmetricKeyType;if(!r)return;const n=ea[r];if(!n)throw new Error(`Unknown key type "${r}".`);if(!n.includes(e))throw new Error(`"alg" parameter for "${r}" key type must be one of: ${n.join(", ")}.`);if(Yi)switch(r){case"ec":const r=t.asymmetricKeyDetails.namedCurve,n=ta[e];if(r!==n)throw new Error(`"alg" parameter "${e}" requires curve "${n}".`);break;case"rsa-pss":if(Qi){const r=parseInt(e.slice(-3),10),{hashAlgorithm:n,mgf1HashAlgorithm:s,saltLength:i}=t.asymmetricKeyDetails;if(n!==`sha${r}`||s!==n)throw new Error(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${e}.`);if(void 0!==i&&i>r>>3)throw new Error(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${e}.`)}}},na=Wi.satisfies(process.version,"^6.12.0 || >=8.0.0");const sa=ln,ia=hn,aa=yn,oa=cn,ca=Tn,ua=ra,la=na,da=Ut,{KeyObject:pa,createSecretKey:ha,createPublicKey:fa}=n,ma=["RS256","RS384","RS512"],ya=["ES256","ES384","ES512"],va=["RS256","RS384","RS512"],ga=["HS256","HS384","HS512"];la&&(ma.splice(ma.length,0,"PS256","PS384","PS512"),va.splice(va.length,0,"PS256","PS384","PS512"));var _a=1/0,ba=9007199254740991,Ea=17976931348623157e292,wa=NaN,Sa="[object Arguments]",xa="[object Function]",ka="[object GeneratorFunction]",Oa="[object String]",Ta="[object Symbol]",Ia=/^\s+|\s+$/g,$a=/^[-+]0x[0-9a-f]+$/i,Ra=/^0b[01]+$/i,Na=/^0o[0-7]+$/i,ja=/^(?:0|[1-9]\d*)$/,Aa=parseInt;function Pa(e){return e!=e}function La(e,t){return function(e,t){for(var r=-1,n=e?e.length:0,s=Array(n);++r<n;)s[r]=t(e[r],r,e);return s}(t,(function(t){return e[t]}))}var Ca,Za,Ma=Object.prototype,Da=Ma.hasOwnProperty,Ua=Ma.toString,Va=Ma.propertyIsEnumerable,Ba=(Ca=Object.keys,Za=Object,function(e){return Ca(Za(e))}),Ka=Math.max;function Fa(e,t){var r=Ha(e)||function(e){return function(e){return qa(e)&&Xa(e)}(e)&&Da.call(e,"callee")&&(!Va.call(e,"callee")||Ua.call(e)==Sa)}(e)?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],n=r.length,s=!!n;for(var i in e)!t&&!Da.call(e,i)||s&&("length"==i||za(i,n))||r.push(i);return r}function Ga(e){if(r=(t=e)&&t.constructor,n="function"==typeof r&&r.prototype||Ma,t!==n)return Ba(e);var t,r,n,s=[];for(var i in Object(e))Da.call(e,i)&&"constructor"!=i&&s.push(i);return s}function za(e,t){return!!(t=null==t?ba:t)&&("number"==typeof e||ja.test(e))&&e>-1&&e%1==0&&e<t}var Ha=Array.isArray;function Xa(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=ba}(e.length)&&!function(e){var t=Wa(e)?Ua.call(e):"";return t==xa||t==ka}(e)}function Wa(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function qa(e){return!!e&&"object"==typeof e}var Ja=function(e,t,r,n){var s;e=Xa(e)?e:(s=e)?La(s,function(e){return Xa(e)?Fa(e):Ga(e)}(s)):[],r=r&&!n?function(e){var t=function(e){if(!e)return 0===e?e:0;if(e=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||qa(e)&&Ua.call(e)==Ta}(e))return wa;if(Wa(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Wa(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(Ia,"");var r=Ra.test(e);return r||Na.test(e)?Aa(e.slice(2),r?2:8):$a.test(e)?wa:+e}(e),e===_a||e===-1/0){return(e<0?-1:1)*Ea}return e==e?e:0}(e),r=t%1;return t==t?r?t-r:t:0}(r):0;var i=e.length;return r<0&&(r=Ka(i+r,0)),function(e){return"string"==typeof e||!Ha(e)&&qa(e)&&Ua.call(e)==Oa}(e)?r<=i&&e.indexOf(t,r)>-1:!!i&&function(e,t,r){if(t!=t)return function(e,t,r,n){for(var s=e.length,i=r+(n?1:-1);n?i--:++i<s;)if(t(e[i],i,e))return i;return-1}(e,Pa,r);for(var n=r-1,s=e.length;++n<s;)if(e[n]===t)return n;return-1}(e,t,r)>-1},Ya=Object.prototype.toString;var Qa=function(e){return!0===e||!1===e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Boolean]"==Ya.call(e)},eo=1/0,to=17976931348623157e292,ro=NaN,no="[object Symbol]",so=/^\s+|\s+$/g,io=/^[-+]0x[0-9a-f]+$/i,ao=/^0b[01]+$/i,oo=/^0o[0-7]+$/i,co=parseInt,uo=Object.prototype.toString;function lo(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var po=function(e){return"number"==typeof e&&e==function(e){var t=function(e){if(!e)return 0===e?e:0;if(e=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&uo.call(e)==no}(e))return ro;if(lo(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=lo(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(so,"");var r=ao.test(e);return r||oo.test(e)?co(e.slice(2),r?2:8):io.test(e)?ro:+e}(e),e===eo||e===-1/0){return(e<0?-1:1)*to}return e==e?e:0}(e),r=t%1;return t==t?r?t-r:t:0}(e)},ho=Object.prototype.toString;var fo=function(e){return"number"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Number]"==ho.call(e)};var mo=Function.prototype,yo=Object.prototype,vo=mo.toString,go=yo.hasOwnProperty,_o=vo.call(Object),bo=yo.toString,Eo=function(e,t){return function(r){return e(t(r))}}(Object.getPrototypeOf,Object);var wo=function(e){if(!function(e){return!!e&&"object"==typeof e}(e)||"[object Object]"!=bo.call(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e))return!1;var t=Eo(e);if(null===t)return!0;var r=go.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&vo.call(r)==_o},So=Object.prototype.toString,xo=Array.isArray;var ko=function(e){return"string"==typeof e||!xo(e)&&function(e){return!!e&&"object"==typeof e}(e)&&"[object String]"==So.call(e)},Oo=1/0,To=17976931348623157e292,Io=NaN,$o="[object Symbol]",Ro=/^\s+|\s+$/g,No=/^[-+]0x[0-9a-f]+$/i,jo=/^0b[01]+$/i,Ao=/^0o[0-7]+$/i,Po=parseInt,Lo=Object.prototype.toString;function Co(e,t){var r;if("function"!=typeof t)throw new TypeError("Expected a function");return e=function(e){var t=function(e){if(!e)return 0===e?e:0;if(e=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&Lo.call(e)==$o}(e))return Io;if(Zo(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Zo(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(Ro,"");var r=jo.test(e);return r||Ao.test(e)?Po(e.slice(2),r?2:8):No.test(e)?Io:+e}(e),e===Oo||e===-1/0){return(e<0?-1:1)*To}return e==e?e:0}(e),r=t%1;return t==t?r?t-r:t:0}(e),function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=void 0),r}}function Zo(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var Mo=function(e){return Co(2,e)};const Do=Tn,Uo=na,Vo=ra,Bo=Ut,Ko=Ja,Fo=Qa,Go=po,zo=fo,Ho=wo,Xo=ko,Wo=Mo,{KeyObject:qo,createSecretKey:Jo,createPrivateKey:Yo}=n,Qo=["RS256","RS384","RS512","ES256","ES384","ES512","HS256","HS384","HS512","none"];Uo&&Qo.splice(3,0,"PS256","PS384","PS512");const ec={expiresIn:{isValid:function(e){return Go(e)||Xo(e)&&e},message:'"expiresIn" should be a number of seconds or string representing a timespan'},notBefore:{isValid:function(e){return Go(e)||Xo(e)&&e},message:'"notBefore" should be a number of seconds or string representing a timespan'},audience:{isValid:function(e){return Xo(e)||Array.isArray(e)},message:'"audience" must be a string or array'},algorithm:{isValid:Ko.bind(null,Qo),message:'"algorithm" must be a valid string enum value'},header:{isValid:Ho,message:'"header" must be an object'},encoding:{isValid:Xo,message:'"encoding" must be a string'},issuer:{isValid:Xo,message:'"issuer" must be a string'},subject:{isValid:Xo,message:'"subject" must be a string'},jwtid:{isValid:Xo,message:'"jwtid" must be a string'},noTimestamp:{isValid:Fo,message:'"noTimestamp" must be a boolean'},keyid:{isValid:Xo,message:'"keyid" must be a string'},mutatePayload:{isValid:Fo,message:'"mutatePayload" must be a boolean'},allowInsecureKeySizes:{isValid:Fo,message:'"allowInsecureKeySizes" must be a boolean'},allowInvalidAsymmetricKeyTypes:{isValid:Fo,message:'"allowInvalidAsymmetricKeyTypes" must be a boolean'}},tc={iat:{isValid:zo,message:'"iat" should be a number of seconds'},exp:{isValid:zo,message:'"exp" should be a number of seconds'},nbf:{isValid:zo,message:'"nbf" should be a number of seconds'}};function rc(e,t,r,n){if(!Ho(r))throw new Error('Expected "'+n+'" to be a plain object.');Object.keys(r).forEach((function(s){const i=e[s];if(i){if(!i.isValid(r[s]))throw new Error(i.message)}else if(!t)throw new Error('"'+s+'" is not allowed in "'+n+'"')}))}const nc={audience:"aud",issuer:"iss",subject:"sub",jwtid:"jti"},sc=["expiresIn","notBefore","noTimestamp","audience","issuer","subject","jwtid"];var ic={decode:cn,verify:function(e,t,r,n){let s;if("function"!=typeof r||n||(n=r,r={}),r||(r={}),r=Object.assign({},r),s=n||function(e,t){if(e)throw e;return t},r.clockTimestamp&&"number"!=typeof r.clockTimestamp)return s(new sa("clockTimestamp must be a number"));if(void 0!==r.nonce&&("string"!=typeof r.nonce||""===r.nonce.trim()))return s(new sa("nonce must be a non-empty string"));if(void 0!==r.allowInvalidAsymmetricKeyTypes&&"boolean"!=typeof r.allowInvalidAsymmetricKeyTypes)return s(new sa("allowInvalidAsymmetricKeyTypes must be a boolean"));const i=r.clockTimestamp||Math.floor(Date.now()/1e3);if(!e)return s(new sa("jwt must be provided"));if("string"!=typeof e)return s(new sa("jwt must be a string"));const a=e.split(".");if(3!==a.length)return s(new sa("jwt malformed"));let o;try{o=oa(e,{complete:!0})}catch(e){return s(e)}if(!o)return s(new sa("invalid token"));const c=o.header;let u;if("function"==typeof t){if(!n)return s(new sa("verify must be called asynchronous if secret or public key is provided as a callback"));u=t}else u=function(e,r){return r(null,t)};return u(c,(function(t,n){if(t)return s(new sa("error in secret or public key callback: "+t.message));const u=""!==a[2].trim();if(!u&&n)return s(new sa("jwt signature is required"));if(u&&!n)return s(new sa("secret or public key must be provided"));if(!u&&!r.algorithms)return s(new sa('please specify "none" in "algorithms" to verify unsigned tokens'));if(null!=n&&!(n instanceof pa))try{n=fa(n)}catch(e){try{n=ha("string"==typeof n?Buffer.from(n):n)}catch(e){return s(new sa("secretOrPublicKey is not valid key material"))}}if(r.algorithms||("secret"===n.type?r.algorithms=ga:["rsa","rsa-pss"].includes(n.asymmetricKeyType)?r.algorithms=va:"ec"===n.asymmetricKeyType?r.algorithms=ya:r.algorithms=ma),-1===r.algorithms.indexOf(o.header.alg))return s(new sa("invalid algorithm"));if(c.alg.startsWith("HS")&&"secret"!==n.type)return s(new sa(`secretOrPublicKey must be a symmetric key when using ${c.alg}`));if(/^(?:RS|PS|ES)/.test(c.alg)&&"public"!==n.type)return s(new sa(`secretOrPublicKey must be an asymmetric key when using ${c.alg}`));if(!r.allowInvalidAsymmetricKeyTypes)try{ua(c.alg,n)}catch(e){return s(e)}let l;try{l=da.verify(e,o.header.alg,n)}catch(e){return s(e)}if(!l)return s(new sa("invalid signature"));const d=o.payload;if(void 0!==d.nbf&&!r.ignoreNotBefore){if("number"!=typeof d.nbf)return s(new sa("invalid nbf value"));if(d.nbf>i+(r.clockTolerance||0))return s(new ia("jwt not active",new Date(1e3*d.nbf)))}if(void 0!==d.exp&&!r.ignoreExpiration){if("number"!=typeof d.exp)return s(new sa("invalid exp value"));if(i>=d.exp+(r.clockTolerance||0))return s(new aa("jwt expired",new Date(1e3*d.exp)))}if(r.audience){const e=Array.isArray(r.audience)?r.audience:[r.audience];if(!(Array.isArray(d.aud)?d.aud:[d.aud]).some((function(t){return e.some((function(e){return e instanceof RegExp?e.test(t):e===t}))})))return s(new sa("jwt audience invalid. expected: "+e.join(" or ")))}if(r.issuer){if("string"==typeof r.issuer&&d.iss!==r.issuer||Array.isArray(r.issuer)&&-1===r.issuer.indexOf(d.iss))return s(new sa("jwt issuer invalid. expected: "+r.issuer))}if(r.subject&&d.sub!==r.subject)return s(new sa("jwt subject invalid. expected: "+r.subject));if(r.jwtid&&d.jti!==r.jwtid)return s(new sa("jwt jwtid invalid. expected: "+r.jwtid));if(r.nonce&&d.nonce!==r.nonce)return s(new sa("jwt nonce invalid. expected: "+r.nonce));if(r.maxAge){if("number"!=typeof d.iat)return s(new sa("iat required when maxAge is specified"));const e=ca(r.maxAge,d.iat);if(void 0===e)return s(new sa('"maxAge" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'));if(i>=e+(r.clockTolerance||0))return s(new aa("maxAge exceeded",new Date(1e3*e)))}if(!0===r.complete){const e=o.signature;return s(null,{header:c,payload:d,signature:e})}return s(null,d)}))},sign:function(e,t,r,n){"function"==typeof r?(n=r,r={}):r=r||{};const s="object"==typeof e&&!Buffer.isBuffer(e),i=Object.assign({alg:r.algorithm||"HS256",typ:s?"JWT":void 0,kid:r.keyid},r.header);function a(e){if(n)return n(e);throw e}if(!t&&"none"!==r.algorithm)return a(new Error("secretOrPrivateKey must have a value"));if(null!=t&&!(t instanceof qo))try{t=Yo(t)}catch(e){try{t=Jo("string"==typeof t?Buffer.from(t):t)}catch(e){return a(new Error("secretOrPrivateKey is not valid key material"))}}if(i.alg.startsWith("HS")&&"secret"!==t.type)return a(new Error(`secretOrPrivateKey must be a symmetric key when using ${i.alg}`));if(/^(?:RS|PS|ES)/.test(i.alg)){if("private"!==t.type)return a(new Error(`secretOrPrivateKey must be an asymmetric key when using ${i.alg}`));if(!r.allowInsecureKeySizes&&!i.alg.startsWith("ES")&&void 0!==t.asymmetricKeyDetails&&t.asymmetricKeyDetails.modulusLength<2048)return a(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`))}if(void 0===e)return a(new Error("payload is required"));if(s){try{!function(e){rc(tc,!0,e,"payload")}(e)}catch(e){return a(e)}r.mutatePayload||(e=Object.assign({},e))}else{const t=sc.filter((function(e){return void 0!==r[e]}));if(t.length>0)return a(new Error("invalid "+t.join(",")+" option for "+typeof e+" payload"))}if(void 0!==e.exp&&void 0!==r.expiresIn)return a(new Error('Bad "options.expiresIn" option the payload already has an "exp" property.'));if(void 0!==e.nbf&&void 0!==r.notBefore)return a(new Error('Bad "options.notBefore" option the payload already has an "nbf" property.'));try{!function(e){rc(ec,!1,e,"options")}(r)}catch(e){return a(e)}if(!r.allowInvalidAsymmetricKeyTypes)try{Vo(i.alg,t)}catch(e){return a(e)}const o=e.iat||Math.floor(Date.now()/1e3);if(r.noTimestamp?delete e.iat:s&&(e.iat=o),void 0!==r.notBefore){try{e.nbf=Do(r.notBefore,o)}catch(e){return a(e)}if(void 0===e.nbf)return a(new Error('"notBefore" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}if(void 0!==r.expiresIn&&"object"==typeof e){try{e.exp=Do(r.expiresIn,o)}catch(e){return a(e)}if(void 0===e.exp)return a(new Error('"expiresIn" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}Object.keys(nc).forEach((function(t){const n=nc[t];if(void 0!==r[t]){if(void 0!==e[n])return a(new Error('Bad "options.'+t+'" option. The payload already has an "'+n+'" property.'));e[n]=r[t]}}));const c=r.encoding||"utf8";if("function"!=typeof n){let n=Bo.sign({header:i,payload:e,secret:t,encoding:c});if(!r.allowInsecureKeySizes&&/^(?:RS|PS)/.test(i.alg)&&n.length<256)throw new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`);return n}n=n&&Wo(n),Bo.createSign({header:i,privateKey:t,payload:e,encoding:c}).once("error",n).once("done",(function(e){if(!r.allowInsecureKeySizes&&/^(?:RS|PS)/.test(i.alg)&&e.length<256)return n(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`));n(null,e)}))},JsonWebTokenError:ln,NotBeforeError:hn,TokenExpiredError:yn},ac=c(ic),oc=(e,{env:t,database:r,logger:n})=>{e.post("/",(async(e,s)=>{try{const{userId:n,otp:i}=e.body;if(!n||!i)return s.status(400).json({message:"userId and otp are required"});const a=await r.select("id","role","otp","otp_expires","otp_attempts").from("directus_users").where("id",n).first();if(!a)return s.status(403).json({message:"Invalid user"});if(a.otp_attempts>=3)return s.status(403).json({message:"Too many attempts",step:"enter-email"});if(a.otp!==i)return await r("directus_users").where("id",n).increment("otp_attempts",1),s.status(403).json({message:"Invalid OTP"});if(new Date(a.otp_expires)<new Date)return s.status(403).json({message:"OTP expired",step:"enter-email"});const c={id:a.id,role:a.role,app_access:!1,admin_access:!1},u=o(64),l=new Date(Date.now()+cc(t.REFRESH_TOKEN_TTL||"7d"));e.body.session&&Object.assign(c,{session:u});const d=t[e.body.session?"SESSION_COOKIE_TTL":"ACCESS_TOKEN_TTL"]||"15m",p=ac.sign(c,t.SECRET,{expiresIn:d,issuer:"directus"});return await r("directus_sessions").insert({token:u,user:a.id,expires:l,ip:e.ip,user_agent:e.get("user-agent"),origin:e.get("origin")}),await r("directus_sessions").delete().where("expires","<",new Date),await r("directus_users").where("id",n).update({last_access:new Date,otp:null,otp_expires:null,otp_attempts:0}),e.body.session&&s.cookie("directus_session_token",u,{httpOnly:!0,domain:t.SESSION_COOKIE_DOMAIN,maxAge:cc(t.SESSION_COOKIE_TTL),secure:Boolean(t.SESSION_COOKIE_SECURE),sameSite:t.SESSION_COOKIE_SAME_SITE||"strict"}),s.json({access_token:p,refresh_token:u,expires:cc(d)})}catch(e){return n.error(e),s.status(500).json({message:"Internal server error"})}}))};function cc(e,t=0){try{return kn(e)}catch{return t}}export{oc as default};
